---
title: "ç»“æ„å‹ - è£…é¥°å™¨æ¨¡å¼(Decorator)"
date: 2021-05-07 21:30:12
re: dev-decorator-pattern
star: true
tag: 
  - è®¾è®¡æ¨¡å¼

category:
  - è®¾è®¡æ¨¡å¼
---

# è£…é¥°(Decorator)

:::tip

æŒ‡åœ¨ä¸æ”¹å˜ç°æœ‰å¯¹è±¡ç»“æ„çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åœ°ç»™è¯¥å¯¹è±¡å¢åŠ ä¸€äº›èŒè´£ï¼ˆå³å¢åŠ å…¶é¢å¤–åŠŸèƒ½ï¼‰çš„æ¨¡å¼

:::

## è£…é¥°ï¨¸æ¨¡å¼ä»‹ç»

è£…é¥°å™¨ï¨¸çš„æ ¸å¿ƒå°±æ˜¯åœ¨ **ï¥§æ”¹å˜åŸæœ‰ç±»** çš„åŸºç¡€ä¸Šç»™ç±»æ–°å¢åŠŸèƒ½

é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ä¼šä½¿ç”¨ç»§æ‰¿æ–¹å¼æ¥å®ç°ã€‚ä½†ç»§æ‰¿å…·æœ‰é™æ€ç‰¹å¾ï¼Œè€¦åˆåº¦é«˜ï¼Œå¹¶ä¸”éšç€æ‰©å±•åŠŸèƒ½çš„å¢å¤šï¼Œå­ç±»ä¼šè¿‡å¤šç­‰é—®é¢˜ã€‚ä½†æ˜¯ä½¿ç”¨è£…é¥°ï¨¸æ¨¡å¼ä¼šæ˜¯å¦å¤–ä¸€ç§æ€ï¤·ï¤ä¸ºçµæ´»ï¼Œå¯ä»¥é¿å…ç»§æ‰¿å¯¼è‡´çš„å­ç±»è¿‡å¤š

## è£…é¥°å™¨çš„ç»“æ„

è£…é¥°å™¨ï¨¸ä¸»è¦è§£å†³çš„æ˜¯ç›´æ¥ç»§æ‰¿ä¸‹å› åŠŸèƒ½çš„ä¸æ–­æ¨ªå‘æ‰©å±•å¯¼è‡´å­ç±»è†¨èƒ€çš„é—®é¢˜ï¼Œè€Œä½¿ç”¨è£…é¥°ï¨¸æ¨¡å¼åå°±ä¼šæ¯”ç›´æ¥ç»§æ‰¿æ˜¾å¾—æ›´åŠ çµæ´»åŒæ—¶è¿™æ ·ä¹Ÿå°±ä¸å†éœ€è¦è€ƒè™‘å­ç±»çš„ç»´æŠ¤ã€‚

è¿™ç§è®¾è®¡æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°ç±»ï¼Œç”¨æ¥åŒ…è£…åŸæœ‰çš„ç±»ï¼Œå¹¶åœ¨ä¿æŒç±»æ–¹æ³•ç­¾åå®Œæ•´æ€§çš„å‰æä¸‹ï¼Œæä¾›äº†é¢å¤–çš„åŠŸèƒ½

è£…é¥°å™¨æ¨¡å¼ä¸»è¦åŒ…å«ä»¥ä¸‹è§’è‰²ï¼š

1. æŠ½è±¡æ„ä»¶ï¼ˆComponentï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ª æŠ½è±¡æ¥å£ ä»¥è§„èŒƒå‡†å¤‡æ¥æ”¶é™„åŠ è´£ä»»çš„å¯¹è±¡ã€‚
2. å…·ä½“æ„ä»¶ï¼ˆConcreteComponentï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡æ„ä»¶ï¼Œé€šè¿‡è£…é¥°è§’è‰²ä¸ºå…¶æ·»åŠ ä¸€äº›èŒè´£ã€‚
3. æŠ½è±¡è£…é¥°ï¼ˆDecoratorï¼‰è§’è‰²ï¼šç»§æ‰¿æŠ½è±¡æ„ä»¶ï¼Œå¹¶åŒ…å«å…·ä½“æ„ä»¶çš„å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡å…¶å­ç±»æ‰©å±•å…·ä½“æ„ä»¶çš„åŠŸèƒ½ã€‚
4. å…·ä½“è£…é¥°ï¼ˆConcreteDecoratorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è£…é¥°çš„ç›¸å…³æ–¹æ³•ï¼Œå¹¶ç»™å…·ä½“æ„ä»¶å¯¹è±¡æ·»åŠ é™„åŠ çš„è´£ä»»ã€‚

![mark](https://media.zenghr.cn/blog/img/20210507/44cmIa2m9SQd.png?imageslim)

## è£…é¥°å™¨çš„æ¡ˆä¾‹æ¨¡æ‹Ÿ
å¥¶èŒ¶åº—ä¸­æœ‰å„ç§å„æ ·çš„å¥¶èŒ¶ï¼Œçç å¥¶èŒ¶ã€è“è“å¥¶èŒ¶ï¼Œç”¨æˆ·åœ¨è´­ä¹°æ—¶ï¼Œåº—å‘˜ä¼šé—®æ˜¯å¦è¦åŠ  å¸ƒä¸ã€åŠ ç³–ã€çç ç­‰é…æ–™ï¼Œä¸åŒçš„å¥¶èŒ¶é…ä¸åŒçš„ææ–™ï¼Œä»·æ ¼ä¹Ÿä¸ä¸€è‡´ï¼Œä½¿ç”¨è£…é¥°å™¨æ¨¡å¼è®¾è®¡å®ç°ã€‚

**å®šä¹‰æŠ½è±¡æ„ä»¶è§’è‰²ï¼ˆComponentï¼‰- å¥¶èŒ¶ï¼ˆMilkTeaï¼‰**

```java
public interface MilkTea {
    /**
     * è·å–æœ€ç»ˆä»·æ ¼
     *
     * @return è¿”å›ä»·æ ¼
     */
    public abstract double getPrice();
}
```

**å®šä¹‰å…·ä½“æ„ä»¶ï¼ˆConcreteComponentï¼‰è§’è‰² - çç å¥¶èŒ¶(PearlTea)**

```java
// çç å¥¶èŒ¶
public class PearlTea implements MilkTea{
    @Override
    public double getPrice() {
        return 20.0;
    }
}
```

**è“è“å¥¶èŒ¶(BlueberryTea)**

```java
public class BlueberryTea implements MilkTea {
    @Override
    public double getPrice() {
        return 10.0;
    }
}
```

**å®šä¹‰æŠ½è±¡è£…é¥°ï¼ˆDecoratorï¼‰è§’è‰² - é…æ–™(Decorator)**

```java
public abstract class BatchingDecorator implements MilkTea {
    protected MilkTea milkTea;
}
```

**å…·ä½“è£…é¥°è€… - å¸ƒä¸(Pudding)**

```java
public class PuddingDecorator extends BatchingDecorator {
    public PuddingDecorator(MilkTea milkTea) {
       this.milkTea = milkTea;
    }

    @Override
    public double getPrice() {
        return 5.0 + this.milkTea.getPrice();
    }
}
```

**å…·ä½“è£…é¥°è€… - ç³–(Sugar)**

```java
public class SugarDecorator extends BatchingDecorator {

    public SugarDecorator(MilkTea milkTea) {
        this.milkTea = milkTea;
    }

    @Override
    public double getPrice() {
        return 3.0 + this.milkTea.getPrice();
    }
}
```

**æ¼”ç¤ºæ¡ˆä¾‹**

æˆ‘ä»¬å»å¥¶èŒ¶åº—ä¹°ä¸€æ¯è“è“å¥¶èŒ¶ï¼ŒåŠ ç³–+åŠ å¸ƒä¸ï¼Œè¯·é—®éœ€è¦å¤šå°‘é’±ï¼Ÿ

```java
public class DecoratorExample {
    public static void main(String[] args) {
        // è“è“å¥¶èŒ¶
        MilkTea milkTea = new BlueberryTea();
        // å¸ƒä¸ åŒ…è£…ç±»
        milkTea = new PuddingDecorator(milkTea);
        // åŠ ç³– åŒ…è£…ç±»
        milkTea = new SugarDecorator(milkTea);
        // æ€»ä»·æ ¼ è“è“10.0 + å¸ƒä¸5.0 + ç³–3.0 = 18.0
        System.out.println(milkTea.getPrice());
    }
}
```

## è£…é¥°å™¨æ¨¡å¼çš„åº”ç”¨åœºæ™¯

è£…é¥°å™¨æ¨¡å¼é€šå¸¸åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä½¿ç”¨

- å½“éœ€è¦ç»™ä¸€ä¸ªç°æœ‰ç±»æ·»åŠ é™„åŠ èŒè´£ï¼Œè€Œåˆä¸èƒ½é‡‡ç”¨ç”Ÿæˆå­ç±»çš„æ–¹æ³•è¿›è¡Œæ‰©å……æ—¶ã€‚ä¾‹å¦‚ï¼Œè¯¥ç±»è¢«éšè—æˆ–è€…è¯¥ç±»æ˜¯ç»ˆæç±»æˆ–è€…é‡‡ç”¨ç»§æ‰¿æ–¹å¼ä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ã€‚
- å½“éœ€è¦é€šè¿‡å¯¹ç°æœ‰çš„ä¸€ç»„åŸºæœ¬åŠŸèƒ½è¿›è¡Œæ’åˆ—ç»„åˆè€Œäº§ç”Ÿéå¸¸å¤šçš„åŠŸèƒ½æ—¶ï¼Œé‡‡ç”¨ç»§æ‰¿å…³ç³»å¾ˆéš¾å®ç°ï¼Œè€Œé‡‡ç”¨è£…é¥°å™¨æ¨¡å¼å´å¾ˆå¥½å®ç°ã€‚
- å½“å¯¹è±¡çš„åŠŸèƒ½è¦æ±‚å¯ä»¥åŠ¨æ€åœ°æ·»åŠ ï¼Œä¹Ÿå¯ä»¥å†åŠ¨æ€åœ°æ’¤é”€æ—¶ã€‚



è£…é¥°å™¨æ¨¡å¼åœ¨ Java ä¸­çš„æœ€è‘—åçš„åº”ç”¨è«è¿‡äº Java I/O æ ‡å‡†åº“çš„è®¾è®¡äº†ã€‚ä¾‹å¦‚ï¼š

- InputStream çš„å­ç±» FilterInputStream
- OutputStream çš„å­ç±» FilterOutputStream
- Reader çš„å­ç±» BufferedReader ä»¥åŠ FilterReader
- è¿˜æœ‰ Writer çš„å­ç±» BufferedWriterã€FilterWriter ä»¥åŠ PrintWriter ç­‰ï¼Œå®ƒä»¬éƒ½æ˜¯æŠ½è±¡è£…é¥°ç±»

å¦‚éœ€äº†è§£ I/O ç±»ä¸­çš„è£…é¥°å™¨æ¨¡å¼ï¼Œè¯·çœ‹ğŸ‘‰ [Java - I/O è£…é¥°å™¨æ¨¡å¼](/passages/2021-05-06-java-io-decorator-pattern.html)

## å‚è€ƒèµ„æ–™

[ç»“æ„å‹ - è£…é¥°(Decorator) - Java å…¨æ ˆçŸ¥è¯†ä½“ç³»](https://www.pdai.tech/md/dev-spec/pattern/12_decorator.html)

[è£…é¥°å™¨æ¨¡å¼è¯¦è§£ - Cè¯­è¨€ä¸­æ–‡ç½‘](http://c.biancheng.net/view/1366.html)