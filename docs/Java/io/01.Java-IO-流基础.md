---
title: "Java I/OæµåŸºç¡€"
date: 2021-05-05 16:00:00
re: 2021-05-05-java-io-basic
category:
  - Java
---

# I/O æµåŸºç¡€çŸ¥è¯†

:::tip

æœ¬æ–‡æ—¨æ„æŒæ¡ I/O æµçš„åŸºç¡€çŸ¥è¯†ä»¥åŠæµçš„åŸºæœ¬æ“ä½œã€‚

:::

## File ç±»

File ç†è§£ä¸ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰ï¼Œç”¨äºè¡¨ç¤ºç£ç›˜ä¸­æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚è¯¥ç±»åŒ…å«äº†æ–‡ä»¶çš„åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç­‰æ–¹æ³•ã€‚åªèƒ½è®¾ç½®å’Œè·å–æ–‡ä»¶æœ¬èº«çš„ä¿¡æ¯ï¼ˆæ–‡ä»¶å¤§å°ï¼Œæ˜¯å¦å¯è¯»ï¼‰ï¼Œä¸èƒ½è®¾ç½®å’Œè·å–æ–‡ä»¶é‡Œé¢çš„å†…å®¹ã€‚

- Unix: ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œä½¿ç”¨ **(/)** æ¥è¡¨ç¤ºè·¯å¾„åˆ†éš”ç¬¦ã€‚
- Windows: é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œä½¿ç”¨ **(\\)** æ¥åˆ†å‰²ç›®å½•è·¯å¾„ã€‚ä½†æ˜¯åœ¨Javaä¸­ä¸€ä¸ª **(\\)** è¡¨ç¤ºè½¬ä¹‰ï¼Œæ‰€ä»¥åœ¨ Windows ç³»ç»Ÿä¸­å°±å¾—ä½¿ç”¨ä¸¤ä¸ª \\\

**æ“ä½œ File çš„å¸¸ç”¨æ–¹æ³•**

- getName() - è·å–æ–‡ä»¶å
- getParent() - è·å–ä¸Šå±‚è·¯å¾„åç§°ï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„æ²¡æœ‰ä¸Šå±‚è·¯å¾„ï¼Œè¿”å› nullï¼‰
- getParentFile() - è·å–ä¸Šå±‚è·¯å¾„çš„ File å¯¹è±¡
- getAbsolutePath() - è·å–ç»å¯¹è·¯å¾„
- getAbsoluteFile() - è·å–ç»å¯¹è·¯å¾„çš„ File å¯¹è±¡
- list() - è·å–è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å
- listFiles() - è·å–è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ File å¯¹è±¡
- exists() - åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- createNewFile() - åˆ›å»ºæ–°æ–‡ä»¶
- isDirectory() - åˆ¤æ–­æ˜¯å¦æ˜¯ç›®å½•
- mkdir() - åˆ›å»ºæ–°ç›®å½•
- mkdirs() - åˆ›å»ºæ–°ç›®å½•ï¼ˆè¡¥å……ä¸å­˜åœ¨çš„ä¸Šå±‚ç›®å½•ï¼‰
- renameTo() - ç§»åŠ¨é‡å‘½åæ–‡ä»¶
- delete() - åˆ é™¤æ–‡ä»¶



## å­—ç¬¦ç¼–ç 

### å¸¸è§çš„å­—ç¬¦é›†

- **ASCIIï¼šå ä¸€ä¸ªå­—èŠ‚ï¼Œåªèƒ½åŒ…å«128ä¸ªç¬¦å·ã€‚ä¸èƒ½è¡¨ç¤ºæ±‰å­—ã€‚**
- **ISO-8859-1ï¼šä¹Ÿç§°ä¹‹ä¸ºlatin-1ï¼Œå ä¸€ä¸ªå­—èŠ‚ï¼Œæ”¶å½•è¥¿æ¬§è¯­è¨€ï¼Œä¸èƒ½è¡¨ç¤ºæ±‰å­—ã€‚**
- GB2312/GBK/GB18030ï¼šå ä¸¤ä¸ªå­—èŠ‚ï¼Œæ”¯æŒä¸­æ–‡ã€‚
- ANSIï¼šå ä¸¤ä¸ªå­—èŠ‚ï¼Œåœ¨ç®€ä½“ä¸­æ–‡çš„æ“ä½œç³»ç»Ÿä¸­ANSI å°±æŒ‡çš„æ˜¯ GBKã€‚
- **UTF-8ï¼šæ˜¯ä¸€ç§é’ˆå¯¹Unicodeçš„å¯å˜é•¿åº¦å­—ç¬¦ç¼–ç ï¼Œæ˜¯Unicodeçš„å®ç°æ–¹å¼ä¹‹ä¸€ï¼Œæ”¯æŒä¸­æ–‡ã€‚åœ¨å¼€**
  **å‘ä¸­å»ºè®®ä½¿ç”¨**

### ç¼–ç è§£ç æ“ä½œ

æ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“æ˜¯ä»¥äºŒè¿›åˆ¶çš„æ ¼å¼ï¼ŒäºŒè¿›åˆ¶æ ¼å¼å°±æ˜¯ byte æ•°ç»„ï¼Œæ­¤æ—¶éœ€è¦æŠŠä¿¡æ¯åšç¼–ç å’Œè§£ç å¤„ç†

- ç¼–ç ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºbyteæ•°ç»„ String--->byte[]
- è§£ç ï¼šæŠŠ byte æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² byte[]--->String

**æ³¨æ„ï¼šä¸€å®šè¦ä¿è¯ç¼–ç å’Œè§£ç çš„å­—ç¬¦é›†ç›¸åŒï¼Œæ‰èƒ½æ­£ç¡®è§£ç å‡ºä¿¡æ¯**

:::tip

ä¹±ç é—®é¢˜çš„æ ¹æœ¬åŸå› å°±æ˜¯ ç¼–ç å’Œè§£ç ä½¿ç”¨çš„å­—ç¬¦é›†ä¸æ˜¯åŒä¸€ç§ï¼Œè§£å†³æ–¹æ³• ç»Ÿä¸€ç¼–ç å­—ç¬¦é›†

:::



## å››å¤§åŸºæµ

:::tip

InputStream/OutputStream åªå®šä¹‰äº†æµçš„æµå‘å’Œæµé€šé“çš„æ•°æ®å•å…ƒï¼Œå¹¶æ²¡æœ‰å®šä¹‰æºæ•°æ®æºå’Œç›®çš„åœ°

java.ioåŒ…ä¸­çš„ç±»æ˜¯æŒ‰ç…§ æºæ•°æ®æº å’Œ ç›®çš„åœ° è¿›è¡Œåˆ’åˆ†çš„ã€‚

java.ioåŒ…ä¸­çš„ç±»å‘½åè§„åˆ™ï¼š**æ•°æ®æº/ç›®çš„åœ° + æ•°æ®ä¼ è¾“å•å…ƒ** *e.gï¼šFile + InputStream / File + Reader*

:::

æ ¹æ®æµçš„ä¸åŒç‰¹æ€§ï¼Œæµçš„åˆ’åˆ†æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸€èˆ¬æŒ‰ç…§å¦‚ä¸‹æƒ…å†µæ¥è€ƒè™‘:

- æŒ‰æµåŠ¨æ–¹å‘ï¼šåˆ†ä¸º è¾“å…¥æµ å’Œ è¾“å‡ºæµ
- æŒ‰æ•°æ®ä¼ è¾“å•ä½ï¼šåˆ†ä¸º å­—èŠ‚æµ å’Œ å­—ç¬¦æµï¼Œå³æ¯æ¬¡ä¼ é€’ä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰æˆ–ä¸€ä¸ªå­—ç¬¦ï¼ˆcharï¼‰
- æŒ‰åŠŸèƒ½ä¸Šåˆ’åˆ†ï¼šåˆ†ä¸º èŠ‚ç‚¹æµ å’Œ å¤„ç†æµï¼ŒèŠ‚ç‚¹æµåŠŸèƒ½å•ä¸€ï¼Œå¤„ç†æµåŠŸèƒ½æ›´å¼º

|  æµå‘  |    å­—èŠ‚æµ    | å­—ç¬¦æµ |
| :----: | :----------: | :----: |
| è¾“å…¥æµ | InputStream  | Reader |
| è¾“å‡ºæµ | OutputStream | Writer |

## å­—èŠ‚è¾“å…¥/å­—èŠ‚è¾“å‡ºæµ


![mark](https://media.zenghr.cn/blog/img/20210505/PTuOyaS8Y46e.png?imageslim)

### InputStream(å­—èŠ‚è¾“å…¥æµ)

InputStream ä»£è¡¨å­—èŠ‚è¾“å…¥æµçš„æ‰€æœ‰ç±»çš„çˆ¶ç±»

**å¸¸ç”¨æ–¹æ³•**

| æ–¹æ³•                  | æ–¹æ³•ä½œç”¨                                                     |
| :-------------------- | ------------------------------------------------------------ |
| int read()            | ä»è¾“å…¥æµä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®å¹¶è¿”å›è¯¥å­—èŠ‚æ•°æ®ï¼Œå¦‚æœåˆ°è¾¾æµçš„æœ«å°¾ï¼Œåˆ™è¿”å› -1 |
| int read(byte[] buff) | ä»è¾“å…¥æµä¸­è¯»å–å¤šä¸ªå­—èŠ‚æ•°æ®ï¼Œå¹¶å­˜å‚¨åœ¨ç¼“å†²åŒºæ•°ç»„ buff ä¸­ã€‚è¿”å›å·²è¯»å–çš„å­—èŠ‚æ•°é‡ï¼Œå¦‚æœå·²åˆ°è¾¾æµçš„æœ«å°¾ï¼Œåˆ™è¿”å› -1 |
| void close()          | å…³é—­æ­¤è¾“å…¥æµå¹¶é‡Šæ”¾ä¸è¯¥æµå…³è”çš„æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚InputStream çš„ close æ–¹æ³•ä¸æ‰§è¡Œä»»ä½•æ“ä½œ |

### OutputStream(å­—èŠ‚è¾“å‡ºæµ)

OutputStream ä»£è¡¨å­—èŠ‚è¾“å‡ºæµçš„æ‰€æœ‰ç±»çš„çˆ¶ç±»

**å¸¸ç”¨æ–¹æ³•**

| æ–¹æ³•                                      | æ–¹æ³•ä½œç”¨                                               |
| ----------------------------------------- | ------------------------------------------------------ |
| void write(int b)                         | å°†æŒ‡å®šçš„ä¸€ä¸ªå­—èŠ‚æ•°æ®bå†™å…¥åˆ°è¾“å‡ºæµä¸­                    |
| void write(byte[] buff)                   | æŠŠæ•°ç»„buffä¸­æ‰€æœ‰å­—èŠ‚æ•°æ®å†™å…¥åˆ°è¾“å‡ºæµä¸­                 |
| void write(byte[] buff, int off, int len) | æŠŠæ•°ç»„buffä¸­ä»ç´¢å¼• off å¼€å§‹çš„ len ä¸ªå­—èŠ‚å†™å…¥æ­¤è¾“å‡ºæµä¸­ |
| void flush()                              | åˆ·æ–°ç¼“å†²åŒº                                             |
| void close()                              | å…³é—­æ­¤è¾“å‡ºæµå¹¶é‡Šæ”¾ä¸æ­¤æµæœ‰å…³çš„æ‰€æœ‰ç³»ç»Ÿèµ„æº             |

### æ–‡ä»¶å­—èŠ‚æµ

æ ¹æ® IO åŒ…ä¸­ç±»çš„å‘½åè§„åˆ™ï¼Œå½“ç¨‹åºæ“ä½œçš„æºæ•°æ®æ˜¯æ–‡ä»¶æ—¶ï¼Œè¾“å…¥å­—èŠ‚æµä½¿ç”¨ **FileInputStream** å®ç°ç±»ï¼Œè¾“å‡ºå­—èŠ‚æµä½¿ç”¨ **FileOutputStream** å®ç°ç±»

```java
public static void main(String[] args) {
    // æºæ•°æ®
    File srcFile = new File("E:\\test\\test.txt");
    File decFile = new File("test.txt");

    // todo: jdk 1.7 è¯­æ³•ï¼Œå®ç°äº† AutoCloseable æ¥å£ä¼šè‡ªåŠ¨å…³é—­
    try (
        FileInputStream in = new FileInputStream(srcFile);
        FileOutputStream out = new FileOutputStream(decFile);
    ) {
        // å¾ªç¯è¯»å–
        int len;
        byte[] buf = new byte[1024];
        while ((len = in.read(buf)) != -1) {
            out.write(buf, 0, len);
            out.flush();
        }
    } catch (IOException e) {
        e.printStackTrace();
    }


}
```



## å­—ç¬¦è¾“å…¥/è¾“å‡ºæµ

![mark](https://media.zenghr.cn/blog/img/20210505/HnpYqN6waVjY.png?imageslim)

### Reader(å­—ç¬¦è¾“å…¥æµ)

Reader è¡¨ç¤ºå­—ç¬¦è¾“å…¥æµçš„æ‰€æœ‰ç±»çš„è¶…ç±»

**å¸¸ç”¨æ–¹æ³•**

| æ–¹æ³•                  | æ–¹æ³•ä½œç”¨                                                     |
| :-------------------- | ------------------------------------------------------------ |
| int read()            | ä»è¾“å…¥æµä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®å¹¶è¿”å›è¯¥å­—èŠ‚æ•°æ®ï¼Œå¦‚æœåˆ°è¾¾æµçš„æœ«å°¾ï¼Œåˆ™è¿”å› -1 |
| int read(char[] cbuf) | ä»è¾“å…¥æµä¸­è¯»å–å¤šä¸ªå­—èŠ‚æ•°æ®ï¼Œå¹¶å­˜å‚¨åœ¨ç¼“å†²åŒºæ•°ç»„ cbuf ä¸­ã€‚è¿”å›å·²è¯»å–çš„å­—èŠ‚æ•°é‡ï¼Œå¦‚æœå·²åˆ°è¾¾æµçš„æœ«å°¾ï¼Œåˆ™è¿”å› -1 |
| void close()          | å…³é—­æ­¤è¾“å…¥æµå¹¶é‡Šæ”¾ä¸è¯¥æµå…³è”çš„æ‰€æœ‰ç³»ç»Ÿèµ„æº                   |

### Writer(å­—ç¬¦è¾“å‡ºæµ)

Writer ä»£è¡¨å­—ç¬¦è¾“å‡ºæµçš„æ‰€æœ‰ç±»çš„è¶…ç±»

**å¸¸ç”¨æ–¹æ³•**

| æ–¹æ³•                                     | æ–¹æ³•ä½œç”¨                                                 |
| ---------------------------------------- | -------------------------------------------------------- |
| void write(int c)                        | å°†æŒ‡å®šçš„ä¸€ä¸ªå­—ç¬¦æ•°æ® c å†™å…¥åˆ°è¾“å‡ºæµä¸­                    |
| void write(char[] cbuf)                  | æŠŠæ•°ç»„ cbuf ä¸­ cbuf.length ä¸ªå­—ç¬¦æ•°æ®å†™å…¥åˆ°è¾“å‡ºæµä¸­      |
| void write(char[] cbuf, int off,int len) | æŠŠæ•°ç»„ cbuf ä¸­ä»ç´¢å¼• off å¼€å§‹çš„ len ä¸ªå­—ç¬¦å†™å…¥æ­¤è¾“å‡ºæµä¸­ |
| void write(String str)                   | å°†strå­—ç¬¦ä¸²æ•°æ®å†™å…¥åˆ°è¾“å‡ºæµä¸­                            |
| void close()                             | å…³é—­æ­¤è¾“å…¥æµå¹¶é‡Šæ”¾ä¸è¯¥æµå…³è”çš„æ‰€æœ‰ç³»ç»Ÿèµ„æº               |
| void flush()                             | åˆ·æ–°æ­¤è¾“å‡ºæµå¹¶å¼ºåˆ¶å†™å‡ºæ‰€æœ‰ç¼“å†²çš„è¾“å‡ºå­—ç¬¦                 |

### æ–‡ä»¶å­—ç¬¦æµ

- FileReader - æ“ä½œæ–‡ä»¶çš„å­—ç¬¦è¾“å…¥æµ
- FileWriter - æ“ä½œæ–‡ä»¶çš„å­—ç¬¦è¾“å‡ºæµ

```java
public static void main(String[] args) {
    // æºæ•°æ®
    File srcFile = new File("E:\\test\\test.txt");
    File decFile = new File("test.txt");

    // todo: jdk 1.7 è¯­æ³•ï¼Œå®ç°äº† AutoCloseable æ¥å£ä¼šè‡ªåŠ¨å…³é—­
    try (
        FileReader in = new FileReader(srcFile);
        FileWriter out = new FileWriter(decFile);
    ) {
        // å¾ªç¯è¯»å–
        int len;
        char[] buf = new char[1024];
        while ((len = in.read(buf)) != -1) {
            out.write(buf, 0, len);
            out.flush();
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

## è¡¥å……çŸ¥è¯†ç‚¹<Badge text="New"/>

:::tip

åœ¨æ–‡ä»¶å¯¹è±¡ä¸­å†™å…¥å†…å®¹çš„æ—¶å€™ï¼Œå¦‚æœè¯¥æ–‡ä»¶å¯¹è±¡å·²ç»æœ‰äº†å…¶ä»–çš„å†…å®¹ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åœ¨ä½¿ç”¨ write æ–¹æ³•å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œä¼šè¦†ç›–æ‰åŸæœ‰çš„å†…å®¹ï¼Œå¦‚æœæƒ³è¦åœ¨åŸæœ‰çš„å†…å®¹ä¸Šè¿½åŠ éœ€è¦ä½¿ç”¨æ„é€ å™¨ **FileWriter`(String fileName, boolean append)`** ï¼Œè®¾ç½®ä¸º **true**ï¼Œæ·»åŠ æ•°æ®å°±ä¼šåœ¨åŸæœ‰å†…å®¹çš„åŸºç¡€ä¸Šè¿½åŠ 

:::

**åœ¨ JDK 1.7 çš„æ–°è¯­æ³•ä¸­ï¼Œå®ç°äº† AutoCloseable æ¥å£çš„ç±»ä¼šè‡ªåŠ¨å¸®ä½ å…³é—­èµ„æºï¼Œè¯­æ³•å¦‚ä¸‹ğŸ‘‡**

```java
try (
    FileInputStream in = new FileInputStream(srcFile);
    FileOutputStream out = new FileOutputStream(decFile);
) {
    // ... ä»£ç å—
} catch (Exception e) {
    // ..
}
```

## æŒ‰èµ„æºåˆ†ç±»I/Oæµ

![mark](https://media.zenghr.cn/blog/img/20210505/rEusKzmBjKae.png?imageslim)

## ç¼“å†²æµ

**èŠ‚ç‚¹æµ**çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ï¼Œæ€§èƒ½è¾ƒä½ã€‚

**å¤„ç†æµ**ï¼Œä¹Ÿç§°ä¹‹ä¸º**åŒ…è£…æµ**ï¼Œç›¸å¯¹äºèŠ‚ç‚¹æµæ›´é«˜çº§ï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªè®¾è®¡æ¨¡å¼â€”â€” **è£…é¥°è®¾è®¡æ¨¡å¼**

å¦‚éœ€è¦è¿›ä¸€æ­¥äº†è§£ è£…é¥°è€…æ¨¡å¼ å¯ä»¥çœ‹ï¼š[Java IO - è®¾è®¡æ¨¡å¼(è£…é¥°è€…æ¨¡å¼)](/passages/2021-05-07-java.html)

ç¼“å†²æµå†…ç½®äº†ä¸€ä¸ªå¤§å°ä¸º 8192 çš„ç¼“å†²åŒºï¼Œç”¨äºå‡å°‘ç£ç›˜çš„æ“ä½œï¼Œå­˜æ»¡ 8192 ç¼“å†²åŒºæ‰ä¼šå†™å…¥ç£ç›˜ä¸­ï¼Œæ“ä½œæ•°æ®é‡æ¯”è¾ƒå¤§çš„æµï¼Œå»ºè®®éƒ½ç”¨ç¼“å†²æµï¼Œç¼“å†²æµæ ¹æ®å››å¤§åŸºæµéƒ½æœ‰å¯¹åº”çš„ç¼“å†²æµ

```java
BufferedInputStream / BufferedOutputStream / BufferedReader / BufferedWriter
```

### å­—èŠ‚ç¼“å†²æµ

å­—èŠ‚ç¼“å†²æµçš„ API æ–¹æ³•åŸºæœ¬å’Œ å­—èŠ‚åŸºæµçš„æ“ä½œä¸€è‡´

- BufferedInputStream
- BufferedOutputStream

```java
public static void main(String[] args) {
    // æºæ•°æ®
    File srcFile = new File("E:\\test\\test.txt");
    File decFile = new File("test.txt");

    // todo: jdk 1.7 è¯­æ³•ï¼Œå®ç°äº† AutoCloseable æ¥å£ä¼šè‡ªåŠ¨å…³é—­
    try (
        FileInputStream in = new FileInputStream(srcFile);
        FileOutputStream out = new FileOutputStream(decFile);
        // buff ç¼“å†²åŒºåŒ…è£…ç±»
        BufferedInputStream buffIn = new BufferedInputStream(in);
        BufferedOutputStream buffOut = new BufferedOutputStream(out);
    ) {
        // å¾ªç¯è¯»å–
        int len;
        byte[] buf = new byte[1024];
        while ((len = buffIn.read(buf)) != -1) {
            buffOut.write(buf, 0, len);
        }
        buffOut.flush();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

### å­—ç¬¦ç¼“å†²æµ

**BufferedReader** ç»§æ‰¿äº Readerï¼Œå®ç°å¯¹æ–‡æœ¬å‹æ–‡ä»¶è¿›è¡Œé«˜æ•ˆ(ä¸€æ¬¡è¯»å–ä¸€è¡Œ)çš„è¯»å–ï¼Œæä¾›ç‰¹æœ‰çš„æ–¹æ³• **readLine()** è¯»å–ä¸€è¡Œ

**BufferedWriter** ç»§æ‰¿äº Writerï¼Œå®ç°å¯¹æ–‡æœ¬å‹æ–‡ä»¶è¿›è¡Œé«˜æ•ˆçš„å†™å…¥ï¼Œæä¾›ç‰¹æœ‰çš„æ–¹æ³• **newLine()** å†™å…¥ä¸€ä¸ªæ¢è¡Œ

```java
ublic static void main(String[] args) {
    // æºæ•°æ®
    File srcFile = new File("E:\\test\\test.txt");
    File decFile = new File("test.txt");

    // todo: jdk 1.7 è¯­æ³•ï¼Œå®ç°äº† AutoCloseable æ¥å£ä¼šè‡ªåŠ¨å…³é—­
    try (
        FileReader in = new FileReader(srcFile);
        FileWriter out = new FileWriter(decFile);
        // buff ç¼“å†²åŒºåŒ…è£…ç±»
        BufferedReader buffIn = new BufferedReader(in);
        BufferedWriter buffOut = new BufferedWriter(out);
    ) {
        // å¾ªç¯è¯»å–æ¯ä¸€è¡Œ
        String line;
        while ((line = buffIn.readLine()) != null) {
            // ä¸€è¡Œä¸€è¡Œå†™å…¥æ–‡ä»¶
            buffOut.write(line);
            // å†™å…¥æ¢è¡Œ
            buffOut.newLine();
        }
        // åˆ·æ–°ç¼“å†²åŒº
        buffOut.flush();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

## serializable(å¯¹è±¡åºåˆ—åŒ–)

**åºåˆ—åŒ–ï¼š** æŒ‡æŠŠ Java å †å†…å­˜ä¸­çš„å¯¹è±¡æ•°æ®ï¼Œé€šè¿‡æŸç§æ–¹å¼æŠŠå¯¹è±¡æ•°æ®å­˜å‚¨åˆ°ç£ç›˜æ–‡ä»¶ä¸­æˆ–è€…ä¼ é€’ç»™ç»™ç½‘ç»œä¸Šä¼ è¾“ã€‚åºåˆ—åŒ–åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨åº”ç”¨éå¸¸å¹¿æ³›

**ååºåˆ—åŒ–ï¼š** æŠŠç£ç›˜æ–‡ä»¶ä¸­çš„å¯¹è±¡çš„æ•°æ®æˆ–è€…æŠŠç½‘ç»œèŠ‚ç‚¹ä¸Šçš„å¯¹è±¡æ•°æ®æ¢å¤æˆ Java å¯¹è±¡çš„è¿‡ç¨‹

éœ€è¦åšåºåˆ—åŒ–çš„å¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ï¼š*java.io.Serializable(è¿™åªæ˜¯æ ‡å¿—æ¥å£ï¼Œæ²¡æœ‰æŠ½è±¡æ–¹æ³•)* 

é€šè¿‡ IO ä¸­çš„å¯¹è±¡æµæ¥åšåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œ

- **ObjectInputStreamï¼š** é€šè¿‡ writeObject æ–¹æ³•æ“ä½œåºåˆ—åŒ–
- **ObjectOutoutStreamï¼š** é€šè¿‡ readObject æ–¹æ³•æ“ä½œååºåˆ—åŒ–

**æ³¨æ„ï¼šå¦‚æœå­—æ®µä½¿ç”¨ transient å…³é”®å­—ä¿®é¥°ï¼Œè¯¥å­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–**

```java
// å®ç° serializable æ¥å£
public class User implements Serializable {
    private String name;
    private int age;
    // ä¸åºåˆ—åŒ–
    private transient String password;
	// ... set/get
}
```

**åºåˆ—åŒ–æ“ä½œ**

```java
public static void main(String[] args) throws Exception {
    User user = new User("å¼ ä¸‰", 20, "123456");

    FileOutputStream out = new FileOutputStream("user.dll");
    ObjectOutputStream oos = new ObjectOutputStream(out);
	// åºåˆ—åŒ–å­—èŠ‚å†™å…¥æ–‡ä»¶
    oos.writeObject(user);
	// å…³é—­èµ„æº
    oos.flush();
    oos.close();
}
```

**ååºåˆ—åŒ–æ“ä½œ**

```java
public static void main(String[] args) throws Exception {
    // ååºåˆ—åŒ–
    FileInputStream in = new FileInputStream("user.dll");
    ObjectInputStream ois = new ObjectInputStream(in);
	// è¯»å–æ–‡ä»¶ ååºåˆ—åŒ–æˆ java å¯¹è±¡
    User user = (User) ois.readObject();
    System.out.println(user);
	// å…³é—­èµ„æº
    ois.close();
}
```

**åºåˆ—åŒ–ç‰ˆæœ¬é—®é¢˜**

å½“ç±»å®ç° **Serializable** æ¥å£åï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šæ ¹æ®å­—æ®µç”Ÿæˆä¸€ä¸ªç¼ºçœçš„ **serialVersionUID** å€¼ï¼Œå¹¶åœ¨åºåˆ—åŒ–æ“ä½œæ—¶ï¼Œå†™åˆ°åºåˆ—åŒ–æ•°æ®æ–‡ä»¶ä¸­

ä½†éšç€é¡¹ç›®çš„å‡çº§ç³»ç»Ÿçš„ class æ–‡ä»¶ä¹Ÿä¼šå‡çº§(å¢åŠ ä¸€ä¸ªå­—æ®µ/åˆ é™¤ä¸€ä¸ªå­—æ®µ)ï¼Œæ­¤æ—¶å†é‡æ–°ç¼–è¯‘ï¼Œå¯¹è±¡çš„ **serialVersionUID** å€¼åˆä¼šæ”¹å˜ã€‚é‚£ä¹ˆåœ¨ååºåˆ—åŒ–æ—¶ï¼ŒJVMä¼šæŠŠå¯¹è±¡æ•°æ®æ•°æ®ä¸­çš„ **serialVersionUID** ä¸æœ¬åœ°å­—èŠ‚ç ä¸­çš„ **serialVersionUID** è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå€¼ä¸ç›¸åŒï¼ˆæ„å‘³ç€ç±»çš„ç‰ˆæœ¬ä¸åŒï¼‰ï¼Œé‚£ä¹ˆæŠ¥å¼‚å¸¸ **InvalidClassException**ï¼Œå³ï¼šç±»ç‰ˆæœ¬ä¸å¯¹åº”ï¼Œä¸èƒ½è¿›è¡Œååºåˆ—åŒ–ã€‚å¦‚æœç‰ˆæœ¬å·ç›¸åŒï¼Œåˆ™å¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦‚ä¸‹ğŸ‘‡

![mark](https://media.zenghr.cn/blog/img/20210506/4XlByvYy3I9L.png?imageslim)

ä¸ºäº†é¿å…ä»£ç ç‰ˆæœ¬å‡çº§è€Œé€ æˆååºåˆ—åŒ–å› ç‰ˆæœ¬ä¸å…¼å®¹è€Œå¤±è´¥çš„é—®é¢˜ï¼Œåœ¨å¼€å‘ä¸­æˆ‘ä»¬å¯ä»¥æ•…æ„åœ¨ç±»ä¸­æä¾›ä¸€ä¸ªå›ºå®šçš„ **serialVersionUID** å€¼

```java
class User implements Serializable {
	private static final long serialVersionUID = 1L;
Â Â 	// ..
}
```

