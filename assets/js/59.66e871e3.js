(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{407:function(a,t,s){"use strict";s.r(t);var n=s(2),r=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"springcloud-alibaba-nacos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springcloud-alibaba-nacos"}},[a._v("#")]),a._v(" SpringCloud Alibaba Nacos")]),a._v(" "),t("p",[t("strong",[a._v("Nacos")]),a._v(" 是阿里巴巴开源的一个更易于构建云原生应用的动态服务发现、配置管理和服务管理 平台")]),a._v(" "),t("p",[t("strong",[a._v("参考文档如下👇")])]),a._v(" "),t("blockquote",[t("p",[a._v("Nacos 官网文档地址："),t("a",{attrs:{href:"https://nacos.io/zh-cn/docs/what-is-nacos.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://nacos.io/zh-cn/docs/what-is-nacos.html"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("Nacos Spring Cloud 快速开始："),t("a",{attrs:{href:"https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html"),t("OutboundLink")],1)])]),a._v(" "),t("h2",{attrs:{id:"nacos-搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nacos-搭建"}},[a._v("#")]),a._v(" Nacos 搭建")]),a._v(" "),t("p",[a._v("根据 Nacos 官网的版本选择描述中，可以根据 "),t("a",{attrs:{href:"https://github.com/alibaba/nacos/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("releases"),t("OutboundLink")],1),a._v(" 中找到每个版本的介绍，Spring Cloud 版本对应关系可以查看 "),t("a",{attrs:{href:"https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"}},[a._v("版本说明Wiki"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"获取-nacos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取-nacos"}},[a._v("#")]),a._v(" 获取 Nacos")]),a._v(" "),t("ul",[t("li",[a._v("下载地址："),t("a",{attrs:{href:"https://github.com/alibaba/nacos/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/alibaba/nacos/releases"),t("OutboundLink")],1)]),a._v(" "),t("li",[a._v("搭建文档："),t("a",{attrs:{href:"https://nacos.io/zh-cn/docs/quick-start.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://nacos.io/zh-cn/docs/quick-start.html"),t("OutboundLink")],1)])]),a._v(" "),t("h3",{attrs:{id:"启动、关闭服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动、关闭服务"}},[a._v("#")]),a._v(" 启动、关闭服务")]),a._v(" "),t("p",[t("strong",[a._v("Linux/Unix/Mac")])]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Linux/Unix/Mac")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动命令(standalone代表着单机模式运行，非集群模式):")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" startup.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" standalone\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" shutdown.sh\n")])])]),t("p",[t("strong",[a._v("Window")])]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动命令(standalone代表着单机模式运行，非集群模式):")]),a._v("\nstartup.cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" standalone\nshutdown.cmd\n")])])]),t("h3",{attrs:{id:"访问-nacos-后台界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#访问-nacos-后台界面"}},[a._v("#")]),a._v(" 访问 Nacos 后台界面")]),a._v(" "),t("p",[a._v("当我们的 Nacos 运行起来时，我们可以访问 "),t("a",{attrs:{href:"http://127.0.0.1:8848/nacos",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://127.0.0.1:8848/nacos"),t("OutboundLink")],1),a._v(" 地址，输入账号密码："),t("strong",[t("code",[a._v("nacos")])]),a._v(" 登录系统")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210727/XOjON2.png",alt:"XOjON2"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210727/ZoWv68.png",alt:"ZoWv68"}})]),a._v(" "),t("h2",{attrs:{id:"环境说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境说明"}},[a._v("#")]),a._v(" 环境说明")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",[t("strong",[a._v("Spring Cloud：")]),a._v(" 2020.0.3")]),a._v(" "),t("p",[t("strong",[a._v("Nacos：")]),a._v(" 14.2")]),a._v(" "),t("p",[t("strong",[a._v("spring-cloud-alibaba：")]),a._v(" 2021.1")])]),a._v(" "),t("p",[a._v("关于 Nacos Spring Cloud 的详细文档请参看："),t("a",{attrs:{href:"https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/Nacos-config",target:"_blank",rel:"noopener noreferrer"}},[a._v("Nacos Config"),t("OutboundLink")],1),a._v(" 和 "),t("a",{attrs:{href:"https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/Nacos-discovery",target:"_blank",rel:"noopener noreferrer"}},[a._v("Nacos Discovery"),t("OutboundLink")],1),a._v("。")]),a._v(" "),t("ul",[t("li",[a._v("通过 Nacos Server 和 spring-cloud-starter-alibaba-nacos-config 实现配置的动态变更。")]),a._v(" "),t("li",[a._v("通过 Nacos Server 和 spring-cloud-starter-alibaba-nacos-discovery 实现服务的注册与发现。")])]),a._v(" "),t("h2",{attrs:{id:"服务发现是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务发现是什么"}},[a._v("#")]),a._v(" 服务发现是什么")]),a._v(" "),t("h3",{attrs:{id:"服务提供者与服务消费者"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务提供者与服务消费者"}},[a._v("#")]),a._v(" 服务提供者与服务消费者")]),a._v(" "),t("ul",[t("li",[a._v("服务提供者：服务的被调用方（即：为其他微服务提供接口的微服务）")]),a._v(" "),t("li",[a._v("服务消费者：服务的调用方（即：调用其他微服务接口的微服务）")])]),a._v(" "),t("h3",{attrs:{id:"服务发现原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务发现原理"}},[a._v("#")]),a._v(" 服务发现原理")]),a._v(" "),t("ul",[t("li",[a._v("服务发现机制就是通过一个中间件去记录服务提供者的ip地址，服务名以及心跳等数据（比如用mysql去存储这些信息），然后服务消费者会去这个中间平台去查询相关信息，然后再去访问对应的地址，这就是服务注册和服务发现。")]),a._v(" "),t("li",[a._v("当用户地址发生了变化也没有影响，因为服务提供方修改了用户地址，在中间件中会被更新，当服务消费方去访问中间件时就能及时获取最新的用户地址，就不会出现用户地址发生变化导致服务找不到")])]),a._v(" "),t("h2",{attrs:{id:"启动服务发现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动服务发现"}},[a._v("#")]),a._v(" 启动服务发现")]),a._v(" "),t("p",[a._v("我们通过 spring-cloud-starter-alibaba-nacos-discovery 来实现服务注册和发现")]),a._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),t("p",[a._v("注意：如果你的 Spring Cloud 版本是 2020，那么 配置文件 "),t("strong",[a._v("bootstrap.yml")]),a._v(" 将会不起作用，会导致 nacos 的配置管理、服务发现等配置失效，需要添加依赖，详细方案请看 "),t("RouterLink",{attrs:{to:"/passages/2021-07-27-spring-cloud-error.html#spring-cloud-2020-bootstrap-配置文件失效"}},[a._v("Spring Cloud 趟坑记录")])],1)]),a._v(" "),t("h3",{attrs:{id:"添加依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖"}},[a._v("#")]),a._v(" 添加依赖")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- nacos 服务发现 --\x3e")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("更多版本对应关系参考："),t("a",{attrs:{href:"https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"}},[a._v("版本说明 Wiki"),t("OutboundLink")],1)])]),a._v(" "),t("h3",{attrs:{id:"添加配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加配置"}},[a._v("#")]),a._v(" 添加配置")]),a._v(" "),t("p",[a._v("通过 Nacos 的服务注册发现功能将其服务注册到 Nacos server 上")]),a._v(" "),t("p",[t("strong",[a._v("在 "),t("code",[a._v("bootstrap.yml")]),a._v(" 中配置 Nacos server 的地址")])]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("order\n")])])]),t("blockquote",[t("p",[a._v("注意：需要配置 application.name 属性，因为 Nacos 注册服务默认取 "),t("strong",[a._v("${spring.application.name}")]),a._v(" 的值")])]),a._v(" "),t("h3",{attrs:{id:"添加注解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加注解"}},[a._v("#")]),a._v(" 添加注解")]),a._v(" "),t("p",[t("strong",[a._v("早期在启动类上需要加上 @EnableDiscoveryClient注解，现在已经可以不需要加了")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210727/Hpj6v9.png",alt:"Hpj6v9"}})]),a._v(" "),t("h2",{attrs:{id:"启动配置管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动配置管理"}},[a._v("#")]),a._v(" 启动配置管理")]),a._v(" "),t("p",[a._v("我们通过 Nacos Server 和 "),t("strong",[a._v("spring-cloud-starter-alibaba-nacos-config")]),a._v(" 实现配置的动态变更")]),a._v(" "),t("h3",{attrs:{id:"添加依赖-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖-2"}},[a._v("#")]),a._v(" 添加依赖")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- nacos 配置中心 --\x3e")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-config"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("更多版本对应关系参考："),t("a",{attrs:{href:"https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"}},[a._v("版本说明 Wiki"),t("OutboundLink")],1)])]),a._v(" "),t("h3",{attrs:{id:"添加配置-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加配置-2"}},[a._v("#")]),a._v(" 添加配置")]),a._v(" "),t("p",[t("strong",[a._v("在 "),t("code",[a._v("bootstrap.properties")]),a._v(" 中配置 Nacos server 的地址和应用名")])]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("order\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",[a._v("说明：之所以需要配置 "),t("code",[a._v("spring.application.name")]),a._v(" ，是因为它是构成 Nacos 配置管理 "),t("code",[a._v("dataId")]),a._v("字段的一部分")]),a._v(" "),t("p",[t("strong",[a._v("dataId = ${prefix}-${spring.profiles.active}.${file-extension}")])])]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("prefix：")]),a._v("  默认为 "),t("code",[a._v("spring.application.name")]),a._v(" 的值，也可以通过配置项 "),t("code",[a._v("spring.cloud.nacos.config.prefix")]),a._v("来配置。")]),a._v(" "),t("li",[t("strong",[a._v("spring.profiles.active：")]),a._v(" 即为当前环境对应的 profile，详情可以参考 "),t("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html#boot-features-profiles",target:"_blank",rel:"noopener noreferrer"}},[a._v("Spring Boot文档"),t("OutboundLink")],1),a._v("。 "),t("strong",[a._v("注意：当 spring.profiles.active 为空时，对应的连接符 "),t("code",[a._v("-")]),a._v(" 也将不存在，dataId 的拼接格式变成 "),t("code",[a._v("${prefix}.${file-extension}")])])]),a._v(" "),t("li",[t("strong",[a._v("file-exetension：")]),a._v(" 为配置内容的数据格式，可以通过配置项 "),t("code",[a._v("spring.cloud.nacos.config.file-extension")]),a._v(" 来配置。目前只支持 "),t("code",[a._v("properties")]),a._v(" 和 "),t("code",[a._v("yaml")]),a._v(" 类型。")])]),a._v(" "),t("blockquote",[t("p",[a._v("即，采用上述配置，"),t("code",[a._v("nacosconfig")]),a._v(" 会从 Nacos Server 读取 Data Id 为 "),t("code",[a._v("nacosconfig.yaml")]),a._v(" 的配置。")])]),a._v(" "),t("h3",{attrs:{id:"nacos-控制台添加配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nacos-控制台添加配置文件"}},[a._v("#")]),a._v(" Nacos 控制台添加配置文件")]),a._v(" "),t("p",[a._v("在 Nacos 控制台添加一个新的配置，其中：")]),a._v(" "),t("ul",[t("li",[a._v("Data Id："),t("code",[a._v("nacosconfig")])]),a._v(" "),t("li",[a._v("Group："),t("code",[a._v("DEFAULT_GROUP")])]),a._v(" "),t("li",[a._v("配置格式："),t("code",[a._v("YAML")])])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210727/JnlTaf.png",alt:"JnlTaf"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210727/hlPcGj.png",alt:"hlPcGj"}})]),a._v(" "),t("h3",{attrs:{id:"读取-nacos-变量配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取-nacos-变量配置"}},[a._v("#")]),a._v(" 读取 Nacos 变量配置")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@RefreshScope")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@RestController")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ConfigController")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Logger")]),a._v(" logger "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("LoggerFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getLogger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ConfigController")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"${order.name:test}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/config"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" method "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("RequestMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("GET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        logger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("info")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"get order config value from nacos: {}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("ul",[t("li",[t("strong",[a._v("RefreshScope：")]),a._v(" 实现配置自动更新，在 nacos 中修改了配置，会动态更新数据")])])])}),[],!1,null,null,null);t.default=r.exports}}]);