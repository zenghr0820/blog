(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{430:function(s,e,t){"use strict";t.r(e);var a=t(2),n=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"redis-æŒä¹…åŒ–æœºåˆ¶"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redis-æŒä¹…åŒ–æœºåˆ¶"}},[s._v("#")]),s._v(" Redis æŒä¹…åŒ–æœºåˆ¶")]),s._v(" "),e("blockquote",[e("p",[s._v("Redisæ˜¯ä¸€ä¸ªæ”¯æŒæŒä¹…åŒ–çš„å†…å­˜æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯è¯´ redis éœ€è¦ç»å¸¸å°†å†…å­˜ä¸­çš„æ•°æ®åŒæ­¥åˆ°ç¡¬ç›˜æ¥ä¿è¯æŒä¹…åŒ–")]),s._v(" "),e("p",[s._v("RedisæŒä¹…åŒ–ä¸»è¦åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯RDBå’ŒAOFï¼Œå½“ç„¶å®é™…åœºæ™¯ä¸‹è¿˜ä¼šä½¿ç”¨è¿™ä¸¤ç§çš„æ··åˆæ¨¡å¼")])]),s._v(" "),e("h2",{attrs:{id:"å‰è¨€"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),e("p",[s._v("Redisçš„æ•°æ®æ­£å¸¸éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜å†…ï¼Œå¦‚æœå®•æœºçªç„¶å‘ç”Ÿï¼Œæ•°æ®å°±ä¼šå…¨éƒ¨ä¸¢å¤±ï¼Œå› æ­¤éœ€è¦æä¾›ä¸€ç§æ–¹å¼ä¿è¯ redis çš„æ•°æ®ä¸ä¼šå› ä¸ºæ•…éšœè€Œä¸¢å¤±ï¼Œè¿™ç§æœºåˆ¶å°±æ˜¯ "),e("strong",[s._v("redis çš„æŒä¹…åŒ–æœºåˆ¶")])]),s._v(" "),e("p",[s._v("ç›®å‰ Redis ä¸»æµçš„æŒä¹…åŒ–æœºåˆ¶æœ‰ä¸¤ç§ï¼šRDB æ–¹å¼ å’Œ AOF æ–¹å¼")]),s._v(" "),e("h2",{attrs:{id:"rdb-æŒä¹…åŒ–"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rdb-æŒä¹…åŒ–"}},[s._v("#")]),s._v(" RDB æŒä¹…åŒ–")]),s._v(" "),e("blockquote",[e("p",[s._v("RDBæŒä¹…åŒ–æ˜¯æŠŠå½“å‰è¿›ç¨‹æ•°æ®ç”Ÿæˆå¿«ç…§ä¿å­˜åˆ°ç¡¬ç›˜çš„è¿‡ç¨‹ï¼Œè§¦å‘RDBæŒä¹…åŒ–è¿‡ç¨‹åˆ†ä¸º "),e("strong",[s._v("æ‰‹åŠ¨è§¦å‘")]),s._v(" å’Œ "),e("strong",[s._v("è‡ªåŠ¨è§¦å‘")])])]),s._v(" "),e("h3",{attrs:{id:"æ‰‹åŠ¨è§¦å‘"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ‰‹åŠ¨è§¦å‘"}},[s._v("#")]),s._v(" æ‰‹åŠ¨è§¦å‘")]),s._v(" "),e("p",[s._v("æ‰‹åŠ¨è§¦å‘åˆ†åˆ«å¯¹åº” save å’Œ bgsave å‘½ä»¤")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("saveå‘½ä»¤")]),s._v("ï¼šé˜»å¡å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œå¯¹äºå†…å­˜ æ¯”è¾ƒå¤§çš„å®ä¾‹ä¼šé€ æˆé•¿æ—¶é—´"),e("strong",[s._v("é˜»å¡")]),s._v("ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨")]),s._v(" "),e("li",[e("strong",[s._v("bgsaveå‘½ä»¤")]),s._v("ï¼šRedisè¿›ç¨‹æ‰§è¡Œforkæ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼ŒRDBæŒä¹…åŒ–è¿‡ç¨‹ç”±å­è¿›ç¨‹è´Ÿè´£ï¼Œå®Œæˆåè‡ªåŠ¨ç»“æŸã€‚é˜»å¡åªå‘ç”Ÿåœ¨forké˜¶æ®µï¼Œä¸€èˆ¬æ—¶é—´å¾ˆçŸ­")])]),s._v(" "),e("blockquote",[e("p",[s._v("bgsave å‘½ä»¤æ˜¯é’ˆå¯¹ save é˜»å¡é—®é¢˜åšçš„ä¼˜åŒ–ï¼Œå› æ­¤Rediså†…éƒ¨æ‰€æœ‰æ¶‰åŠåˆ°RDBæ“ä½œéƒ½é‡‡ç”¨ bgsave çš„æ–¹å¼ï¼Œè€Œ "),e("s",[s._v("save")]),s._v(" å‘½ä»¤å¯ä»¥åºŸå¼ƒ")])]),s._v(" "),e("p",[s._v("bgsaveæµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºğŸ‘‡")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210802/eFa8oF.png",alt:"eFa8oF"}})]),s._v(" "),e("p",[s._v("å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š")]),s._v(" "),e("ul",[e("li",[s._v("redis å®¢æˆ·ç«¯æ‰§è¡Œ bgsave å‘½ä»¤æˆ–è€…è‡ªåŠ¨è§¦å‘bgsaveå‘½ä»¤ï¼›")]),s._v(" "),e("li",[s._v("ä¸»è¿›ç¨‹åˆ¤æ–­å½“å‰æ˜¯å¦å·²ç»å­˜åœ¨æ­£åœ¨æ‰§è¡Œçš„å­è¿›ç¨‹ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆä¸»è¿›ç¨‹ç›´æ¥è¿”å›ï¼›")]),s._v(" "),e("li",[s._v("å¦‚æœä¸å­˜åœ¨æ­£åœ¨æ‰§è¡Œçš„å­è¿›ç¨‹ï¼Œé‚£ä¹ˆå°±forkä¸€ä¸ªæ–°çš„å­è¿›ç¨‹è¿›è¡ŒæŒä¹…åŒ–æ•°æ®ï¼Œforkè¿‡ç¨‹æ˜¯é˜»å¡çš„ï¼Œforkæ“ä½œå®Œæˆåä¸»è¿›ç¨‹å³å¯æ‰§è¡Œå…¶ä»–æ“ä½œï¼›")]),s._v(" "),e("li",[s._v("å­è¿›ç¨‹å…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸´æ—¶çš„rdbæ–‡ä»¶ä¸­ï¼Œå¾…å¿«ç…§æ•°æ®å†™å…¥å®Œæˆåå†åŸå­æ›¿æ¢æ—§çš„rdbæ–‡ä»¶ï¼›")]),s._v(" "),e("li",[s._v("åŒæ—¶å‘é€ä¿¡å·ç»™ä¸»è¿›ç¨‹ï¼Œé€šçŸ¥ä¸»è¿›ç¨‹rdbæŒä¹…åŒ–å®Œæˆï¼Œä¸»è¿›ç¨‹æ›´æ–°ç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆinfo Persitenceä¸‹çš„rdb_*ç›¸å…³é€‰é¡¹ï¼‰")])]),s._v(" "),e("h3",{attrs:{id:"è‡ªåŠ¨è§¦å‘"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªåŠ¨è§¦å‘"}},[s._v("#")]),s._v(" è‡ªåŠ¨è§¦å‘")]),s._v(" "),e("blockquote",[e("p",[s._v("åœ¨ä»¥ä¸‹4ç§æƒ…å†µæ—¶ä¼šè‡ªåŠ¨è§¦å‘")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("redis.confä¸­é…ç½®"),e("code",[s._v("save m n")]),s._v("ï¼Œå³åœ¨mç§’å†…æœ‰næ¬¡ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨è§¦å‘bgsaveç”Ÿæˆrdbæ–‡ä»¶ï¼›")])]),s._v(" "),e("li",[e("p",[s._v("ä¸»ä»å¤åˆ¶æ—¶ï¼Œä»èŠ‚ç‚¹è¦ä»ä¸»èŠ‚ç‚¹è¿›è¡Œå…¨é‡å¤åˆ¶æ—¶ä¹Ÿä¼šè§¦å‘bgsaveæ“ä½œï¼Œç”Ÿæˆå½“æ—¶çš„å¿«ç…§å‘é€åˆ°ä»èŠ‚ç‚¹ï¼›")])]),s._v(" "),e("li",[e("p",[s._v("æ‰§è¡Œ "),e("strong",[s._v("debug reload")]),s._v(" å‘½ä»¤é‡æ–°åŠ è½½ redis æ—¶ä¹Ÿä¼šè§¦å‘bgsaveæ“ä½œï¼›")])]),s._v(" "),e("li",[e("p",[s._v("é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œshutdownå‘½ä»¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯ aofæŒä¹…åŒ–ï¼Œé‚£ä¹ˆä¹Ÿä¼šè§¦å‘bgsaveæ“ä½œ")])])]),s._v(" "),e("h3",{attrs:{id:"redis-confä¸­é…ç½®rdb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redis-confä¸­é…ç½®rdb"}},[s._v("#")]),s._v(" redis.confä¸­é…ç½®RDB")]),s._v(" "),e("ul",[e("li",[s._v("é…ç½®è®¾ç½®è‡ªåŠ¨åšå¿«ç…§æŒä¹…åŒ–æ–¹å¼")])]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘¨æœŸæ€§æ‰§è¡Œæ¡ä»¶çš„è®¾ç½®æ ¼å¼ä¸º")]),s._v("\nsave "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("seconds"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("changes"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é»˜è®¤çš„è®¾ç½®ä¸ºï¼š")]),s._v("\nsave "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("900")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nsave "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nsave "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä»¥ä¸‹è®¾ç½®æ–¹å¼ä¸ºå…³é—­RDBå¿«ç…§åŠŸèƒ½")]),s._v("\nsave "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n")])])]),e("p",[s._v("ä»¥ä¸Šä¸‰é¡¹é»˜è®¤ä¿¡æ¯è®¾ç½®ä»£è¡¨çš„æ„ä¹‰æ˜¯ï¼š")]),s._v(" "),e("ul",[e("li",[s._v("å¦‚æœ900ç§’å†…æœ‰1æ¡Keyä¿¡æ¯å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿›è¡Œå¿«ç…§ï¼›")]),s._v(" "),e("li",[s._v("å¦‚æœ300ç§’å†…æœ‰10æ¡Keyä¿¡æ¯å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿›è¡Œå¿«ç…§ï¼›")]),s._v(" "),e("li",[s._v("å¦‚æœ60ç§’å†…æœ‰10000æ¡Keyä¿¡æ¯å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿›è¡Œå¿«ç…§ã€‚è¯»è€…å¯ä»¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™ï¼Œæ ¹æ®è‡ªå·±çš„å®é™…è¯·æ±‚å‹åŠ›è¿›è¡Œè®¾ç½®è°ƒæ•´")])]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ–‡ä»¶åç§°")]),s._v("\ndbfilename dump.rdb\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ–‡ä»¶ä¿å­˜è·¯å¾„")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /home/work/app/redis/data/\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚æœæŒä¹…åŒ–å‡ºé”™ï¼Œä¸»è¿›ç¨‹æ˜¯å¦åœæ­¢å†™å…¥")]),s._v("\nstop-writes-on-bgsave-error "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ˜¯å¦å‹ç¼©")]),s._v("\nrdbcompression "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯¼å…¥æ—¶æ˜¯å¦æ£€æŸ¥")]),s._v("\nrdbchecksum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])])]),e("ul",[e("li",[e("p",[e("strong",[s._v("dbfilenameï¼š")]),s._v(" é…ç½®æ–‡ä»¶åï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œ "),e("code",[s._v("config set dir {newDir}")]),s._v(" å’Œ "),e("code",[s._v("config set dbfilename {newFileName}")]),s._v(" è¿è¡ŒæœŸåŠ¨æ€æ‰§è¡Œï¼Œå½“ä¸‹æ¬¡è¿è¡Œæ—¶RDBæ–‡ä»¶ä¼šä¿å­˜åˆ°æ–°ç›®å½•")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("dirï¼š")]),s._v(" å¯ä»¥é€šè¿‡æ‰§è¡Œ "),e("code",[s._v("config set dir {newDir}")]),s._v(" å’Œ "),e("code",[s._v("config set dbfilename {newFileName}")]),s._v(" è¿è¡ŒæœŸåŠ¨æ€æ‰§è¡Œï¼Œå½“ä¸‹æ¬¡è¿è¡Œæ—¶RDBæ–‡ä»¶ä¼šä¿å­˜åˆ°æ–°ç›®å½•")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("å‹ç¼©ï¼š")]),s._v(" Redisé»˜è®¤é‡‡ç”¨ "),e("strong",[s._v("LZFç®—æ³•")]),s._v(" å¯¹ç”Ÿæˆçš„RDBæ–‡ä»¶åšå‹ç¼©å¤„ç†ï¼Œå‹ç¼©åçš„æ–‡ä»¶è¿œè¿œå°äºå†…å­˜å¤§å°ï¼Œé»˜è®¤å¼€å¯ï¼Œå¯ä»¥é€šè¿‡å‚æ•° "),e("code",[s._v("config set rdbcompression {yes|no}")]),s._v(" åŠ¨æ€ä¿®æ”¹ã€‚")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("æ ¡éªŒï¼š")]),s._v(" å¦‚æœRedisåŠ è½½æŸåçš„RDBæ–‡ä»¶æ—¶æ‹’ç»å¯åŠ¨ï¼Œè¿™ä¸ªåŠŸèƒ½å¤§æ¦‚ä¼šå¤šæŸå¤±10%å·¦å³çš„æ€§èƒ½ï¼Œä½†è·å¾—äº†æ›´é«˜çš„æ•°æ®å¯é æ€§ã€‚æ‰€ä»¥å¦‚æœæ‚¨çš„RedisæœåŠ¡éœ€è¦è¿½æ±‚æè‡´çš„æ€§èƒ½ï¼Œå°±å¯ä»¥å°†è¿™ä¸ªé€‰é¡¹è®¾ç½®ä¸º no")])])]),s._v(" "),e("h3",{attrs:{id:"rdb-çš„ä¼˜ç¼ºç‚¹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rdb-çš„ä¼˜ç¼ºç‚¹"}},[s._v("#")]),s._v(" RDB çš„ä¼˜ç¼ºç‚¹")]),s._v(" "),e("ul",[e("li",[e("p",[e("strong",[s._v("ä¼˜ç‚¹ï¼š")])]),s._v(" "),e("ul",[e("li",[s._v("RDBæ–‡ä»¶æ˜¯æŸä¸ªæ—¶é—´èŠ‚ç‚¹çš„å¿«ç…§ï¼Œé»˜è®¤ä½¿ç”¨LZFç®—æ³•è¿›è¡Œå‹ç¼©ï¼Œå‹ç¼©åçš„æ–‡ä»¶ä½“ç§¯è¿œè¿œå°äºå†…å­˜å¤§å°ï¼Œé€‚ç”¨äºå¤‡ä»½ã€å…¨é‡å¤åˆ¶ç­‰åœºæ™¯")]),s._v(" "),e("li",[s._v("RedisåŠ è½½RDBæ–‡ä»¶æ¢å¤æ•°æ®è¦è¿œè¿œå¿«äºAOFæ–¹å¼")])])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("ç¼ºç‚¹ï¼š")])]),s._v(" "),e("ul",[e("li",[s._v("RDBæ–¹å¼å®æ—¶æ€§ä¸å¤Ÿï¼Œæ— æ³•åšåˆ°ç§’çº§çš„æŒä¹…åŒ–ï¼›")]),s._v(" "),e("li",[s._v("æ¯æ¬¡è°ƒç”¨bgsaveéƒ½éœ€è¦forkå­è¿›ç¨‹ï¼Œforkå­è¿›ç¨‹å±äºé‡é‡çº§æ“ä½œï¼Œé¢‘ç¹æ‰§è¡Œæˆæœ¬è¾ƒé«˜ï¼›")]),s._v(" "),e("li",[s._v("RDBæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶çš„ï¼Œæ²¡æœ‰å¯è¯»æ€§ï¼ŒAOFæ–‡ä»¶åœ¨äº†è§£å…¶ç»“æ„çš„æƒ…å†µä¸‹å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹æˆ–è€…è¡¥å…¨ï¼›")]),s._v(" "),e("li",[s._v("ç‰ˆæœ¬å…¼å®¹RDBæ–‡ä»¶é—®é¢˜")])]),s._v(" "),e("p",[s._v("é’ˆå¯¹RDBä¸é€‚åˆå®æ—¶æŒä¹…åŒ–çš„é—®é¢˜ï¼ŒRedisæä¾›äº† "),e("strong",[s._v("AOFæŒä¹…åŒ–")]),s._v(" æ–¹å¼æ¥è§£å†³")])])]),s._v(" "),e("h2",{attrs:{id:"aof-æŒä¹…åŒ–"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#aof-æŒä¹…åŒ–"}},[s._v("#")]),s._v(" AOF æŒä¹…åŒ–")]),s._v(" "),e("blockquote",[e("p",[s._v("AOF(append only file)æŒä¹…åŒ–ï¼šä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œé‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­å‘½ä»¤è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚")]),s._v(" "),e("p",[s._v("AOFçš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ï¼Œç›®å‰å·²ç»æ˜¯ "),e("strong",[s._v("RedisæŒä¹…åŒ–çš„ä¸»æµæ–¹å¼")])])]),s._v(" "),e("p",[s._v("è€ŒAOFæ—¥å¿—é‡‡ç”¨å†™åæ—¥å¿—ï¼Œå³ "),e("strong",[s._v("å…ˆå†™å†…å­˜ï¼Œåå†™æ—¥å¿—")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210802/a20AVK.jpeg",alt:"a20AVK"}})]),s._v(" "),e("p",[s._v("Redisè¦æ±‚é«˜æ€§èƒ½ï¼Œé‡‡ç”¨å†™æ—¥å¿—æœ‰ä¸¤æ–¹é¢å¥½å¤„ï¼š")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("é¿å…é¢å¤–çš„æ£€æŸ¥å¼€é”€")]),s._v("ï¼šRedis åœ¨å‘ AOF é‡Œé¢è®°å½•æ—¥å¿—çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå…ˆå»å¯¹è¿™äº›å‘½ä»¤è¿›è¡Œè¯­æ³•æ£€æŸ¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœå…ˆè®°æ—¥å¿—å†æ‰§è¡Œå‘½ä»¤çš„è¯ï¼Œæ—¥å¿—ä¸­å°±æœ‰å¯èƒ½è®°å½•äº†é”™è¯¯çš„å‘½ä»¤ï¼ŒRedis åœ¨ä½¿ç”¨æ—¥å¿—æ¢å¤æ•°æ®æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºé”™ã€‚")]),s._v(" "),e("li",[s._v("ä¸ä¼šé˜»å¡å½“å‰çš„å†™æ“ä½œ")])]),s._v(" "),e("p",[s._v("ä½†è¿™ç§æ–¹å¼å­˜åœ¨æ½œåœ¨é£é™©ï¼š")]),s._v(" "),e("ul",[e("li",[s._v("å¦‚æœå‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œå†™æ—¥å¿—ä¹‹å‰å®•æœºäº†ï¼Œä¼šä¸¢å¤±æ•°æ®ã€‚")]),s._v(" "),e("li",[s._v("ä¸»çº¿ç¨‹å†™ç£ç›˜å‹åŠ›å¤§ï¼Œå¯¼è‡´å†™ç›˜æ…¢ï¼Œé˜»å¡åç»­æ“ä½œ")])]),s._v(" "),e("h3",{attrs:{id:"å¦‚ä½•å®ç°-aof"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•å®ç°-aof"}},[s._v("#")]),s._v(" å¦‚ä½•å®ç° AOF")]),s._v(" "),e("p",[s._v("AOFæ—¥å¿—è®°å½•Redisçš„æ¯ä¸ªå†™å‘½ä»¤ï¼Œæ­¥éª¤åˆ†ä¸ºï¼šå‘½ä»¤è¿½åŠ ï¼ˆappendï¼‰ã€æ–‡ä»¶å†™å…¥ï¼ˆwriteï¼‰å’Œæ–‡ä»¶åŒæ­¥ï¼ˆsyncï¼‰")]),s._v(" "),e("ul",[e("li",[e("p",[e("strong",[s._v("å‘½ä»¤è¿½åŠ ")]),s._v(" å½“AOFæŒä¹…åŒ–åŠŸèƒ½æ‰“å¼€äº†ï¼ŒæœåŠ¡å™¨åœ¨æ‰§è¡Œå®Œä¸€ä¸ªå†™å‘½ä»¤ä¹‹åï¼Œä¼šä»¥åè®®æ ¼å¼å°†è¢«æ‰§è¡Œçš„å†™å‘½ä»¤è¿½åŠ åˆ°æœåŠ¡å™¨çš„ "),e("strong",[s._v("aof_buf")]),s._v(" ç¼“å†²åŒºã€‚")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("æ–‡ä»¶å†™å…¥å’ŒåŒæ­¥")]),s._v(" å…³äºä½•æ—¶å°† aof_buf ç¼“å†²åŒºçš„å†…å®¹å†™å…¥AOFæ–‡ä»¶ä¸­ï¼ŒRedisæä¾›äº†ä¸‰ç§å†™å›ç­–ç•¥")])])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210802/LATaFC.jpeg",alt:"LATaFC"}})]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Always")]),s._v(" - åŒæ­¥å†™å›ï¼šæ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œç«‹é©¬åŒæ­¥åœ°å°†æ—¥å¿—å†™å›ç£ç›˜")]),s._v(" "),e("li",[e("strong",[e("code",[s._v("Everysec(æ¨è)")])]),s._v(" - æ¯ç§’å†™å›ï¼šæ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œåªæ˜¯å…ˆæŠŠæ—¥å¿—å†™åˆ°AOFæ–‡ä»¶çš„å†…å­˜ç¼“å†²åŒºï¼Œæ¯éš”ä¸€ç§’æŠŠç¼“å†²åŒºä¸­çš„å†…å®¹å†™å…¥ç£ç›˜")]),s._v(" "),e("li",[e("strong",[s._v("No")]),s._v("  - æ“ä½œç³»ç»Ÿæ§åˆ¶çš„å†™å›ï¼šæ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œåªæ˜¯å…ˆæŠŠæ—¥å¿—å†™åˆ°AOFæ–‡ä»¶çš„å†…å­˜ç¼“å†²åŒºï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å†²åŒºå†…å®¹å†™å›ç£ç›˜(ä¸æ¨è)")])]),s._v(" "),e("h3",{attrs:{id:"conf-é…ç½®aof"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#conf-é…ç½®aof"}},[s._v("#")]),s._v(" Conf é…ç½®AOF")]),s._v(" "),e("p",[s._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedisæ˜¯æ²¡æœ‰å¼€å¯AOFçš„ï¼Œå¯ä»¥é€šè¿‡é…ç½®redis.confæ–‡ä»¶æ¥å¼€å¯AOFæŒä¹…åŒ–ï¼Œå…³äºAOFçš„é…ç½®å¦‚ä¸‹ï¼š")]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# appendonlyå‚æ•°å¼€å¯AOFæŒä¹…åŒ–")]),s._v("\nappendonly no\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AOFæŒä¹…åŒ–çš„æ–‡ä»¶åï¼Œé»˜è®¤æ˜¯appendonly.aof")]),s._v("\nappendfilename "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appendonly.aof"')]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AOFæ–‡ä»¶çš„ä¿å­˜ä½ç½®å’ŒRDBæ–‡ä»¶çš„ä½ç½®ç›¸åŒï¼Œéƒ½æ˜¯é€šè¿‡dirå‚æ•°è®¾ç½®çš„")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" ./\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŒæ­¥ç­–ç•¥")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# appendfsync always")]),s._v("\nappendfsync everysec\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# appendfsync no")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# aofé‡å†™æœŸé—´æ˜¯å¦åŒæ­¥")]),s._v("\nno-appendfsync-on-rewrite no\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é‡å†™è§¦å‘é…ç½®")]),s._v("\nauto-aof-rewrite-percentage "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nauto-aof-rewrite-min-size 64mb\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŠ è½½aofå‡ºé”™å¦‚ä½•å¤„ç†")]),s._v("\naof-load-truncated "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ–‡ä»¶é‡å†™ç­–ç•¥")]),s._v("\naof-rewrite-incremental-fsync "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])])]),e("p",[s._v("ä»¥ä¸‹æ˜¯Redisä¸­å…³äºAOFçš„ä¸»è¦é…ç½®ä¿¡æ¯ï¼š")]),s._v(" "),e("ul",[e("li",[e("p",[e("code",[s._v("appendonly")]),s._v("ï¼šé»˜è®¤æƒ…å†µä¸‹AOFåŠŸèƒ½æ˜¯å…³é—­çš„ï¼Œå°†è¯¥é€‰é¡¹æ”¹ä¸ºyesä»¥ä¾¿æ‰“å¼€Redisçš„AOFåŠŸèƒ½ã€‚")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("appendfilename")]),s._v("ï¼šè¿™ä¸ªå‚æ•°é¡¹å¾ˆå¥½ç†è§£äº†ï¼Œå°±æ˜¯AOFæ–‡ä»¶çš„åå­—")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("appendfsync")]),s._v("ï¼šè¿™ä¸ªå‚æ•°é¡¹æ˜¯AOFåŠŸèƒ½æœ€é‡è¦çš„è®¾ç½®é¡¹ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºè®¾ç½®æ“ä½œå‘½ä»¤å‘AOFæ–‡ä»¶ä¸­åŒæ­¥çš„ç­–ç•¥")])])]),s._v(" "),e("h2",{attrs:{id:"rdbå’Œaofæ··åˆæ–¹å¼"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rdbå’Œaofæ··åˆæ–¹å¼"}},[s._v("#")]),s._v(" RDBå’ŒAOFæ··åˆæ–¹å¼")]),s._v(" "),e("blockquote",[e("p",[s._v("Redis 4.0 ä¸­æå‡ºäº†ä¸€ä¸ª"),e("strong",[s._v("æ··åˆä½¿ç”¨ AOF æ—¥å¿—å’Œå†…å­˜å¿«ç…§")]),s._v("çš„æ–¹æ³•ã€‚ç®€å•æ¥è¯´ï¼Œå†…å­˜å¿«ç…§ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œï¼Œåœ¨ä¸¤æ¬¡å¿«ç…§ä¹‹é—´ï¼Œä½¿ç”¨ AOF æ—¥å¿—è®°å½•è¿™æœŸé—´çš„æ‰€æœ‰å‘½ä»¤æ“ä½œ")])]),s._v(" "),e("p",[s._v("è¿™æ ·ä¸€æ¥ï¼Œå¿«ç…§ä¸ç”¨å¾ˆé¢‘ç¹åœ°æ‰§è¡Œï¼Œè¿™å°±é¿å…äº†é¢‘ç¹ fork å¯¹ä¸»çº¿ç¨‹çš„å½±å“ã€‚è€Œä¸”ï¼ŒAOF æ—¥å¿—ä¹Ÿåªç”¨è®°å½•ä¸¤æ¬¡å¿«ç…§é—´çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦è®°å½•æ‰€æœ‰æ“ä½œäº†ï¼Œå› æ­¤ï¼Œå°±ä¸ä¼šå‡ºç°æ–‡ä»¶è¿‡å¤§çš„æƒ…å†µäº†ï¼Œä¹Ÿå¯ä»¥é¿å…é‡å†™å¼€é”€ã€‚")]),s._v(" "),e("p",[s._v("å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒT1 å’Œ T2 æ—¶åˆ»çš„ä¿®æ”¹ï¼Œç”¨ AOF æ—¥å¿—è®°å½•ï¼Œç­‰åˆ°ç¬¬äºŒæ¬¡åšå…¨é‡å¿«ç…§æ—¶ï¼Œå°±å¯ä»¥æ¸…ç©º AOF æ—¥å¿—ï¼Œå› ä¸ºæ­¤æ—¶çš„ä¿®æ”¹éƒ½å·²ç»è®°å½•åˆ°å¿«ç…§ä¸­äº†ï¼Œæ¢å¤æ—¶å°±ä¸å†ç”¨æ—¥å¿—äº†")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://media.zenghr.cn/blog/img/20210802/yBKz08.jpeg",alt:"yBKz08"}})]),s._v(" "),e("p",[s._v("è¿™ä¸ªæ–¹æ³•æ—¢èƒ½äº«å—åˆ° RDB æ–‡ä»¶å¿«é€Ÿæ¢å¤çš„å¥½å¤„ï¼Œåˆèƒ½äº«å—åˆ° AOF åªè®°å½•æ“ä½œå‘½ä»¤çš„ç®€å•ä¼˜åŠ¿, å®é™…ç¯å¢ƒä¸­ç”¨çš„å¾ˆå¤š")]),s._v(" "),e("h2",{attrs:{id:"å‚è€ƒæ–‡æ¡£"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡æ¡£"}},[s._v("#")]),s._v(" å‚è€ƒæ–‡æ¡£")]),s._v(" "),e("ul",[e("li",[e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/ybyn/p/14157568.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/ybyn/p/14157568.html"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://segmentfault.com/a/1190000015983518",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://segmentfault.com/a/1190000015983518"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://blog.csdn.net/qq_41434612/article/details/108791437",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/qq_41434612/article/details/108791437"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/liang24/p/14180036.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/liang24/p/14180036.html"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.jianshu.com/p/d3ba7b8ad964",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.jianshu.com/p/d3ba7b8ad964"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://blog.csdn.net/liupeifeng3514/article/details/79048767",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/liupeifeng3514/article/details/79048767"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.pdai.tech/md/db/nosql-redis/db-redis-x-rdb-aof.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.pdai.tech/md/db/nosql-redis/db-redis-x-rdb-aof.html"),e("OutboundLink")],1)])])])])}),[],!1,null,null,null);e.default=n.exports}}]);