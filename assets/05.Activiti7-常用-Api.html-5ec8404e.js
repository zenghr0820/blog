import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,a as t}from"./app-0bf44ca3.js";const e={},p=t(`<h1 id="activiti7-å¸¸ç”¨-api" tabindex="-1"><a class="header-anchor" href="#activiti7-å¸¸ç”¨-api" aria-hidden="true">#</a> Activiti7 å¸¸ç”¨ Api</h1><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„ Api ä½¿ç”¨</p></div><h2 id="ä¸€ã€æµç¨‹å®šä¹‰ç›¸å…³-api" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€æµç¨‹å®šä¹‰ç›¸å…³-api" aria-hidden="true">#</a> ä¸€ã€æµç¨‹å®šä¹‰ç›¸å…³ Api</h2><blockquote><p>ä»¥ä¸‹ Api è·Ÿæµç¨‹å®šä¹‰ç›¸å…³</p></blockquote><h2 id="æ ¹æ®æµç¨‹å®šä¹‰-keyæŸ¥è¯¢æµç¨‹" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®æµç¨‹å®šä¹‰-keyæŸ¥è¯¢æµç¨‹" aria-hidden="true">#</a> æ ¹æ®æµç¨‹å®šä¹‰ KeyæŸ¥è¯¢æµç¨‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ProcessDefinition</span> <span class="token function">selectProcessDefinitionByKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> definitionKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProcessDefinition</span><span class="token punctuation">&gt;</span></span> processDefinitions <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">createProcessDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span>definitionKey<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">orderByProcessDefinitionVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ProcessDefinition</span> processDefinition <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>processDefinitions<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        processDefinition <span class="token operator">=</span> processDefinitions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> processDefinition<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Api è¯´æ˜ï¼š</strong></p><ul><li>æ ¹æ®éƒ¨ç½²ç‰ˆæœ¬å€’åºæ’åºï¼Œè·å–æ‰€æœ‰æµç¨‹éƒ¨ç½²ä¿¡æ¯ï¼Œå–æœ€æ–°çš„æ•°æ®</li></ul><h2 id="æ ¹æ®éƒ¨ç½²-id-æŸ¥è¯¢æµç¨‹" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®éƒ¨ç½²-id-æŸ¥è¯¢æµç¨‹" aria-hidden="true">#</a> æ ¹æ®éƒ¨ç½² Id æŸ¥è¯¢æµç¨‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ProcessDefinition</span> <span class="token function">selectProcessDefinitionByDeploymentId</span><span class="token punctuation">(</span><span class="token class-name">String</span> deploymentId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> repositoryService<span class="token punctuation">.</span><span class="token function">createProcessDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">deploymentId</span><span class="token punctuation">(</span>deploymentId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è·å–æµç¨‹-xml-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è·å–æµç¨‹-xml-æ–‡ä»¶" aria-hidden="true">#</a> è·å–æµç¨‹ XML æ–‡ä»¶</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> deploymentId<span class="token punctuation">,</span> <span class="token class-name">String</span> resourceName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> repositoryService<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>deploymentId<span class="token punctuation">,</span> resourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong> å‚æ•°éƒ½ä»æµç¨‹å®šä¹‰ä¸­è·å– processDefinition</p><ul><li><strong>deploymentId</strong> - æµç¨‹éƒ¨ç½² ID</li><li><strong>resourceName</strong> - èµ„æºåç§°</li></ul><h2 id="è·å–å½“å‰æµç¨‹çš„æµç¨‹å›¾-é«˜äº®æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#è·å–å½“å‰æµç¨‹çš„æµç¨‹å›¾-é«˜äº®æ˜¾ç¤º" aria-hidden="true">#</a> è·å–å½“å‰æµç¨‹çš„æµç¨‹å›¾(é«˜äº®æ˜¾ç¤º)</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getProcessImage</span><span class="token punctuation">(</span><span class="token class-name">String</span> processDefinitionId<span class="token punctuation">,</span>
                                   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> highLightedActivities<span class="token punctuation">,</span>
                                   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> highLightedFlows<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BpmnModel</span> model <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">getBpmnModel</span><span class="token punctuation">(</span>processDefinitionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ProcessDiagramGenerator</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultProcessDiagramGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//generateDiagram(æµç¨‹æ¨¡å‹,éœ€è¦é«˜äº®çš„èŠ‚ç‚¹,éœ€è¦é«˜äº®çš„çº¿æ¡,åé¢ä¸‰ä¸ªå‚æ•°éƒ½è¡¨ç¤ºæ˜¯å­—ä½“)</span>
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> generator<span class="token punctuation">.</span><span class="token function">generateDiagram</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> highLightedActivities<span class="token punctuation">,</span> highLightedFlows<span class="token punctuation">,</span> <span class="token string">&quot;å®‹ä½“&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å®‹ä½“&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å®‹ä½“&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> inputStream<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>highLightedActivities</strong> - éœ€è¦é«˜äº®çš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œå­˜èŠ‚ç‚¹ ID</li><li><strong>highLightedFlows</strong> - éœ€è¦é«˜äº®çš„è¿çº¿ï¼Œå­˜è¿çº¿ ID</li></ul><blockquote><p>å¦‚æœæµç¨‹ä¸­æœ‰ä¸­æ–‡ï¼Œéœ€è¦ä¼ å…¥èƒ½è¯†åˆ«ä¸­æ–‡çš„å­—ä½“ï¼Œä¾‹å¦‚ï¼šå®‹ä½“</p></blockquote><h2 id="è·å–æµç¨‹ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#è·å–æµç¨‹ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯" aria-hidden="true">#</a> è·å–æµç¨‹ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findUserTaskNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æµç¨‹ä¿¡æ¯ï¼Œè·å–æ–¹æ³•æŸ¥çœ‹ä¸Šé¢ğŸ‘†æå¾—åˆ°çš„ Api</span>
    <span class="token class-name">ProcessDefinition</span> processDefinition <span class="token operator">=</span> <span class="token function">selectProcessDefinitionByKey</span><span class="token punctuation">(</span><span class="token string">&quot;XXXKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BpmnModel</span> model <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">getBpmnModel</span><span class="token punctuation">(</span>processDefinition<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>model <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FlowElement</span><span class="token punctuation">&gt;</span></span> flowElements <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">getMainProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFlowElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// æŸ¥æ‰¾æŒ‡å®š UserTask ç±»å‹çš„èŠ‚ç‚¹</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">FlowElement</span> e <span class="token operator">:</span> flowElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ¤æ–­èŠ‚ç‚¹ç±»å‹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">UserTask</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å®¡æ‰¹äºº</span>
                <span class="token class-name">String</span> sp1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">UserTask</span><span class="token punctuation">)</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAssignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å€™é€‰äºº</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sp2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">UserTask</span><span class="token punctuation">)</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCandidateUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Api è¯´æ˜ï¼š</strong></p><ul><li>å¯ä»¥è·å–èŠ‚ç‚¹çš„ IDã€åç§°ã€è´Ÿè´£äººã€å€™é€‰äººç­‰ä¿¡æ¯</li></ul><h2 id="äºŒã€æµç¨‹å®ä¾‹ç›¸å…³-api" tabindex="-1"><a class="header-anchor" href="#äºŒã€æµç¨‹å®ä¾‹ç›¸å…³-api" aria-hidden="true">#</a> äºŒã€æµç¨‹å®ä¾‹ç›¸å…³ Api</h2><blockquote><p>ä»¥ä¸‹ Api è·Ÿæµç¨‹å®ä¾‹ç›¸å…³</p></blockquote><h2 id="è·å–æµç¨‹å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#è·å–æµç¨‹å®ä¾‹" aria-hidden="true">#</a> è·å–æµç¨‹å®ä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ProcessInstance</span> <span class="token function">getProcessInstanceById</span><span class="token punctuation">(</span><span class="token class-name">String</span> processInstanceId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> runtimeService<span class="token punctuation">.</span><span class="token function">createProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åˆ é™¤æµç¨‹å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æµç¨‹å®ä¾‹" aria-hidden="true">#</a> åˆ é™¤æµç¨‹å®ä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * åˆ é™¤éƒ¨ç½²çš„æµç¨‹å®ä¾‹
  *
  * <span class="token keyword">@param</span> <span class="token parameter">instanceId</span> æµç¨‹å®ä¾‹ID
  * <span class="token keyword">@param</span> <span class="token parameter">deleteReason</span> åˆ é™¤åŸå› ï¼Œå¯ä¸ºç©º
  */</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteProcIns</span><span class="token punctuation">(</span><span class="token class-name">String</span> instanceId<span class="token punctuation">,</span> <span class="token class-name">String</span> deleteReason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   runtimeService<span class="token punctuation">.</span><span class="token function">deleteProcessInstance</span><span class="token punctuation">(</span>instanceId<span class="token punctuation">,</span> deleteReason<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ ¹æ®æµç¨‹å®ä¾‹è·å–ç›®å‰æ´»åŠ¨èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®æµç¨‹å®ä¾‹è·å–ç›®å‰æ´»åŠ¨èŠ‚ç‚¹" aria-hidden="true">#</a> æ ¹æ®æµç¨‹å®ä¾‹è·å–ç›®å‰æ´»åŠ¨èŠ‚ç‚¹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getActiveActivityIds</span><span class="token punctuation">(</span><span class="token class-name">String</span> processInstanceId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> runtimeService<span class="token punctuation">.</span><span class="token function">getActiveActivityIds</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è·å–å†å²æµç¨‹å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#è·å–å†å²æµç¨‹å®ä¾‹" aria-hidden="true">#</a> è·å–å†å²æµç¨‹å®ä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">HistoricProcessInstance</span> <span class="token function">getHistoricProcessInstanceById</span><span class="token punctuation">(</span><span class="token class-name">String</span> processInstanceId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> historyService
        <span class="token punctuation">.</span><span class="token function">createHistoricProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è·å–å†å²æ‰¹æ³¨ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#è·å–å†å²æ‰¹æ³¨ä¿¡æ¯" aria-hidden="true">#</a> è·å–å†å²æ‰¹æ³¨ä¿¡æ¯</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTaskComments</span><span class="token punctuation">(</span><span class="token class-name">String</span> taskId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Comment</span><span class="token punctuation">&gt;</span></span> taskComments <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">getTaskComments</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>taskComments <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;æš‚æ— æ‰¹æ³¨&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> taskComments<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Comment</span><span class="token operator">::</span><span class="token function">getFullMessage</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è·å–æµç¨‹å®ä¾‹çš„å†å²ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#è·å–æµç¨‹å®ä¾‹çš„å†å²ä»»åŠ¡" aria-hidden="true">#</a> è·å–æµç¨‹å®ä¾‹çš„å†å²ä»»åŠ¡</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HistoricActivityInstance</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectHistoryTaskList</span><span class="token punctuation">(</span><span class="token class-name">String</span> instanceId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> historyService<span class="token punctuation">.</span><span class="token function">createHistoricActivityInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>instanceId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">activityType</span><span class="token punctuation">(</span><span class="token string">&quot;userTask&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">finished</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">orderByHistoricActivityInstanceStartTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>instanceId</strong> - æµç¨‹å®ä¾‹ ID</li><li><strong>activityType</strong> - èŠ‚ç‚¹ç±»å‹</li><li><strong>finished</strong> - å·²å®Œæˆ</li><li>æ ¹æ®åˆ›å»ºæ—¶é—´æ’åº</li></ul><h2 id="ä¸‰ã€æŸ¥è¯¢ä»»åŠ¡ç›¸å…³-api" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æŸ¥è¯¢ä»»åŠ¡ç›¸å…³-api" aria-hidden="true">#</a> ä¸‰ã€æŸ¥è¯¢ä»»åŠ¡ç›¸å…³ Api</h2><blockquote><p>ä»¥ä¸‹ API è·Ÿ Task ä»»åŠ¡æœ‰å…³</p></blockquote><h2 id="æ ¹æ®æµç¨‹å®ä¾‹-id-æŸ¥è¯¢å½“å‰-task" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®æµç¨‹å®ä¾‹-id-æŸ¥è¯¢å½“å‰-task" aria-hidden="true">#</a> æ ¹æ®æµç¨‹å®ä¾‹ ID æŸ¥è¯¢å½“å‰ Task</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTaskByInstanceId</span><span class="token punctuation">(</span><span class="token class-name">String</span> instanceId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>instanceId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="task-æ·»åŠ å€™é€‰äºº" tabindex="-1"><a class="header-anchor" href="#task-æ·»åŠ å€™é€‰äºº" aria-hidden="true">#</a> Task æ·»åŠ å€™é€‰äºº</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCandidateUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> taskId<span class="token punctuation">,</span> <span class="token class-name">String</span> candidateUser<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    taskService<span class="token punctuation">.</span><span class="token function">addCandidateUser</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> candidateUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æŸ¥è¯¢å€™é€‰äººå¾…åŠä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢å€™é€‰äººå¾…åŠä»»åŠ¡" aria-hidden="true">#</a> æŸ¥è¯¢å€™é€‰äººå¾…åŠä»»åŠ¡</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectTodoTaskList</span><span class="token punctuation">(</span><span class="token class-name">String</span> definitionKey<span class="token punctuation">,</span> <span class="token class-name">String</span> candidateUser<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span>definitionKey<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">taskCandidateUser</span><span class="token punctuation">(</span>candidateUser<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">orderByTaskCreateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">listPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>definitionKey</strong> - æµç¨‹å®šä¹‰ Key</li><li><strong>candidateUser</strong> - å€™é€‰äºº</li><li>æ ¹æ® task åˆ›å»ºæ—¶é—´æ’åº</li></ul><h2 id="æ ¹æ®-taskid-è·å–-task" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®-taskid-è·å–-task" aria-hidden="true">#</a> æ ¹æ® TaskId è·å– Task</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Task</span> <span class="token function">getTaskByTaskId</span><span class="token punctuation">(</span><span class="token class-name">String</span> taskId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">taskId</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é¢†å–ä»»åŠ¡ä»¥åŠå®Œæˆä»»åŠ¡æ·»åŠ æ‰¹æ³¨" tabindex="-1"><a class="header-anchor" href="#é¢†å–ä»»åŠ¡ä»¥åŠå®Œæˆä»»åŠ¡æ·»åŠ æ‰¹æ³¨" aria-hidden="true">#</a> é¢†å–ä»»åŠ¡ä»¥åŠå®Œæˆä»»åŠ¡æ·»åŠ æ‰¹æ³¨</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">claimAndComplateTask</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token punctuation">,</span> <span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token keyword">boolean</span> auditStatusBoolean<span class="token punctuation">,</span> <span class="token class-name">String</span> commentStr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> taskId <span class="token operator">=</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœå€™é€‰ä»»åŠ¡æ²¡æœ‰è¿›è¡Œé¢†å–å°±ç›´æ¥å®Œæˆçš„è¯ï¼Œé‚£ä¹ˆåœ¨å†å²è®°å½•ä¸­å°±ä¸ä¼šè®°å½•æ˜¯å“ªä¸ªç”¨æˆ·æ‰§è¡Œäº†è¿™ä¸ªä»»åŠ¡.</span>
    taskService<span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ·»åŠ æ‰¹æ³¨</span>
    taskService<span class="token punctuation">.</span><span class="token function">addComment</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> commentStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ·»åŠ æµç¨‹å˜é‡</span>
    taskService<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getTaskDefinitionKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> auditStatusBoolean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å®Œæˆä»»åŠ¡</span>
    taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="task-æ·»åŠ æµç¨‹å˜é‡" tabindex="-1"><a class="header-anchor" href="#task-æ·»åŠ æµç¨‹å˜é‡" aria-hidden="true">#</a> Task æ·»åŠ æµç¨‹å˜é‡</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token class-name">String</span> taskId<span class="token punctuation">,</span> <span class="token class-name">String</span> variableName<span class="token punctuation">,</span> <span class="token class-name">Object</span> variableValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    taskService<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span> variableName<span class="token punctuation">,</span> variableValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æŸ¥è¯¢ç”¨æˆ·å·²åŠä»»åŠ¡åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢ç”¨æˆ·å·²åŠä»»åŠ¡åˆ—è¡¨" aria-hidden="true">#</a> æŸ¥è¯¢ç”¨æˆ·å·²åŠä»»åŠ¡åˆ—è¡¨</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HistoricTaskInstance</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectDoneTaskList</span><span class="token punctuation">(</span><span class="token class-name">String</span> definitionKey<span class="token punctuation">,</span> <span class="token class-name">String</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> historyService
        <span class="token punctuation">.</span><span class="token function">createHistoricTaskInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span>definitionKey<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">finished</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">orderByHistoricTaskInstanceEndTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°è¯´æ˜:</strong></p><ul><li><strong>definitionKey</strong> - æµç¨‹å®šä¹‰ Key</li><li><strong>userId</strong> - å“ªä¸ªç”¨æˆ·çš„å·²åŠ</li><li><strong>finished</strong> - çŠ¶æ€å·²å®Œæˆ</li><li>æ ¹æ®å®Œæˆæ—¶é—´æ’åº</li></ul>`,59),c=[p];function o(i,l){return s(),a("div",null,c)}const r=n(e,[["render",o],["__file","05.Activiti7-å¸¸ç”¨-Api.html.vue"]]);export{r as default};
