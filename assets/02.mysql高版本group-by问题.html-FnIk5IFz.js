import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as t,o as n}from"./app-BdIzuXiJ.js";const l={};function e(p,s){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="解决-mysql-高版本group-by问题" tabindex="-1"><a class="header-anchor" href="#解决-mysql-高版本group-by问题"><span>解决 Mysql 高版本group by问题</span></a></h1><p>在 Mysql 5.7 以上的版本中，默认配置了 <code>sql_mode：ONLY_FULL_GROUP_BY</code> 对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>本文记录一下 mysql 执行 group by 语句时遇到的错误，以及修改方案</p></div><h2 id="查看-mysql-全局的-sql-mode" tabindex="-1"><a class="header-anchor" href="#查看-mysql-全局的-sql-mode"><span>查看 mysql 全局的 sql_mode</span></a></h2><p>进入 Mysql 客户端执行命令：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">select</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> @@</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">global</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">sql_mode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">+</span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">----------------------------------------------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">| @@</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">GLOBAL</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">sql_mode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">                                                                                  |</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">+</span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">----------------------------------------------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">+</span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">----------------------------------------------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> row</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;"> set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#D19A66;">00</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;"> sec)</span></span></code></pre></div><p>可以看到 <strong>ONLY_FULL_GROUP_BY</strong> 就是导致 group by 报错的原因，所以要解决该问题必须要该配置关掉</p><p>于是在网上尝试了很多解决方法，最终发现大部分方法估计写的人自己也没有测试过！！！修改后只会导致更多的错误，所以记录一下解决的过程</p><h2 id="修改-my-cnf-配置文件" tabindex="-1"><a class="header-anchor" href="#修改-my-cnf-配置文件"><span>修改 my.cnf 配置文件</span></a></h2><p>找到 my.cnf 配置文件，添加一条配置</p><blockquote><p>sql_mode=&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&#39;</p></blockquote><p>我的配置文件如下：</p><div class="language-ini" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#abb2bf;--shiki-dark:#abb2bf;--shiki-light-bg:#282c34;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">character_set_server</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 添加的配置</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">sql_mode</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&#39;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">[client]</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">default-character-set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#61AFEF;">[mysql]</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C678DD;">default-character-set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#98C379;">utf8mb4</span></span></code></pre></div><h2 id="sql-mode常用值" tabindex="-1"><a class="header-anchor" href="#sql-mode常用值"><span>sql_mode常用值</span></a></h2><ul><li><strong>ONLY_FULL_GROUP_BY</strong>：对于GROUP BY聚合操作，如果在 SELECT 中的列，没有在 GROUP BY 中出现，那么这个SQL是不合法的</li><li><strong>NO_AUTO_VALUE_ON_ZERO</strong>：该值影响自增长列的插入。默认设置下，插入0或NULL代表生成下一个自增长值。如果用户 希望插入的值为0，而该列又是自增长的，那么这个选项就有用了</li><li><strong>STRICT_TRANS_TABLES</strong>：在该模式下，如果一个值不能插入到一个事务表中，则中断当前的操作，对非事务表不做限制</li><li><strong>NO_ZERO_IN_DATE</strong>：在严格模式下，不允许日期和月份为零</li><li><strong>NO_ZERO_DATE</strong>：设置该值，mysql数据库不允许插入零日期，插入零日期会抛出错误而不是警告。</li><li><strong>ERROR_FOR_DIVISION_BY_ZERO</strong>：在INSERT或UPDATE过程中，如果数据被零除，则产生错误而非警告。如 果未给出该模式，那么数据被零除时MySQL返回NULL</li><li><strong>NO_ENGINE_SUBSTITUTION</strong>：如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，用默认的存储引擎替代，并抛出一个异常</li><li><strong>PIPES_AS_CONCAT</strong>：将&quot;||&quot;视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似</li><li><strong>ANSI_QUOTES</strong>：启用ANSI_QUOTES后，不能用双引号来引用字符串，因为它被解释为识别符</li><li><s><strong>NO_AUTO_CREATE_USER</strong>：禁止GRANT创建密码为空的用户</s> (Mysql8.0以后已经被删除)</li></ul>`,15)]))}const k=i(l,[["render",e]]),o=JSON.parse('{"path":"/database/mysql/02.mysql%E9%AB%98%E7%89%88%E6%9C%ACgroup-by%E9%97%AE%E9%A2%98.html","title":"Mysql 高版本group by问题","lang":"zh-CN","frontmatter":{"title":"Mysql 高版本group by问题","date":"2021-07-06T00:00:00.000Z","re":"group-by-error","description":"解决 Mysql 高版本group by问题 在 Mysql 5.7 以上的版本中，默认配置了 sql_mode：ONLY_FULL_GROUP_BY 对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的 提示 本文记录一下 mysql 执行 group by 语句时遇到的错误，以及修改方案 查...","permalink":"/database/mysql/group-by-error.html","head":[["meta",{"property":"og:url","content":"https://blog.zenghr.cn/database/mysql/group-by-error.html"}],["meta",{"property":"og:site_name","content":"Zenghr"}],["meta",{"property":"og:title","content":"Mysql 高版本group by问题"}],["meta",{"property":"og:description","content":"解决 Mysql 高版本group by问题 在 Mysql 5.7 以上的版本中，默认配置了 sql_mode：ONLY_FULL_GROUP_BY 对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的 提示 本文记录一下 mysql 执行 group by 语句时遇到的错误，以及修改方案 查..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-29T14:19:06.000Z"}],["meta",{"property":"article:published_time","content":"2021-07-06T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-29T14:19:06.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Mysql 高版本group by问题\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-07-06T00:00:00.000Z\\",\\"dateModified\\":\\"2025-04-29T14:19:06.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Zenghr\\"}]}"]]},"git":{"createdTime":1745936346000,"updatedTime":1745936346000,"contributors":[{"name":"zenghr","username":"zenghr","email":"zenghr","commits":1,"url":"https://github.com/zenghr"}]},"readingTime":{"minutes":2.19,"words":656},"filePathRelative":"database/mysql/02.mysql高版本group-by问题.md","localizedDate":"2021年7月6日","excerpt":"\\n<p>在 Mysql 5.7 以上的版本中，默认配置了 <code>sql_mode：ONLY_FULL_GROUP_BY</code>  对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的</p>\\n<div class=\\"hint-container tip\\">\\n<p class=\\"hint-container-title\\">提示</p>\\n<p>本文记录一下 mysql 执行 group by 语句时遇到的错误，以及修改方案</p>\\n</div>\\n<h2>查看 mysql 全局的 sql_mode</h2>\\n<p>进入 Mysql 客户端执行命令：</p>","autoDesc":true}');export{k as comp,o as data};
