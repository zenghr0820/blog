import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as a,a as e}from"./app-c854b126.js";const t={},l=e(`<h1 id="解决-mysql-高版本group-by问题" tabindex="-1"><a class="header-anchor" href="#解决-mysql-高版本group-by问题" aria-hidden="true">#</a> 解决 Mysql 高版本group by问题</h1><p>在 Mysql 5.7 以上的版本中，默认配置了 <code>sql_mode：ONLY_FULL_GROUP_BY</code> 对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>本文记录一下 mysql 执行 group by 语句时遇到的错误，以及修改方案</p></div><h2 id="查看-mysql-全局的-sql-mode" tabindex="-1"><a class="header-anchor" href="#查看-mysql-全局的-sql-mode" aria-hidden="true">#</a> 查看 mysql 全局的 sql_mode</h2><p>进入 Mysql 客户端执行命令：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> @<span class="token variable">@global.sql_mode</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------------------------------------------------------------------------------------------------+</span>
<span class="token operator">|</span> @<span class="token variable">@GLOBAL.sql_mode</span>                                                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------------------------------------------------------------------------------------+</span>
<span class="token operator">|</span> ONLY_FULL_GROUP_BY<span class="token punctuation">,</span>STRICT_TRANS_TABLES<span class="token punctuation">,</span>NO_ZERO_IN_DATE<span class="token punctuation">,</span>NO_ZERO_DATE<span class="token punctuation">,</span>ERROR_FOR_DIVISION_BY_ZERO<span class="token punctuation">,</span>NO_ENGINE_SUBSTITUTION <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------------------------------------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到 <strong>ONLY_FULL_GROUP_BY</strong> 就是导致 group by 报错的原因，所以要解决该问题必须要该配置关掉</p><p>于是在网上尝试了很多解决方法，最终发现大部分方法估计写的人自己也没有测试过！！！修改后只会导致更多的错误，所以记录一下解决的过程</p><h2 id="修改-my-cnf-配置文件" tabindex="-1"><a class="header-anchor" href="#修改-my-cnf-配置文件" aria-hidden="true">#</a> 修改 my.cnf 配置文件</h2><p>找到 my.cnf 配置文件，添加一条配置</p><blockquote><p>sql_mode=&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&#39;</p></blockquote><p>我的配置文件如下：</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">mysqld</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">character_set_server</span><span class="token punctuation">=</span><span class="token value attr-value">utf8mb4</span>
<span class="token comment"># 添加的配置</span>
<span class="token key attr-name">sql_mode</span><span class="token punctuation">=</span><span class="token value attr-value">&#39;<span class="token inner-value">STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span>&#39;</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">client</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">default-character-set</span><span class="token punctuation">=</span><span class="token value attr-value">utf8mb4</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">mysql</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">default-character-set</span><span class="token punctuation">=</span><span class="token value attr-value">utf8mb4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sql-mode常用值" tabindex="-1"><a class="header-anchor" href="#sql-mode常用值" aria-hidden="true">#</a> sql_mode常用值</h2><ul><li><strong>ONLY_FULL_GROUP_BY</strong>：对于GROUP BY聚合操作，如果在 SELECT 中的列，没有在 GROUP BY 中出现，那么这个SQL是不合法的</li><li><strong>NO_AUTO_VALUE_ON_ZERO</strong>：该值影响自增长列的插入。默认设置下，插入0或NULL代表生成下一个自增长值。如果用户 希望插入的值为0，而该列又是自增长的，那么这个选项就有用了</li><li><strong>STRICT_TRANS_TABLES</strong>：在该模式下，如果一个值不能插入到一个事务表中，则中断当前的操作，对非事务表不做限制</li><li><strong>NO_ZERO_IN_DATE</strong>：在严格模式下，不允许日期和月份为零</li><li><strong>NO_ZERO_DATE</strong>：设置该值，mysql数据库不允许插入零日期，插入零日期会抛出错误而不是警告。</li><li><strong>ERROR_FOR_DIVISION_BY_ZERO</strong>：在INSERT或UPDATE过程中，如果数据被零除，则产生错误而非警告。如 果未给出该模式，那么数据被零除时MySQL返回NULL</li><li><strong>NO_ENGINE_SUBSTITUTION</strong>：如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，用默认的存储引擎替代，并抛出一个异常</li><li><strong>PIPES_AS_CONCAT</strong>：将&quot;||&quot;视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似</li><li><strong>ANSI_QUOTES</strong>：启用ANSI_QUOTES后，不能用双引号来引用字符串，因为它被解释为识别符</li><li><s><strong>NO_AUTO_CREATE_USER</strong>：禁止GRANT创建密码为空的用户</s> (Mysql8.0以后已经被删除)</li></ul>`,15),o=[l];function p(c,i){return n(),a("div",null,o)}const u=s(t,[["render",p],["__file","02.mysql高版本group-by问题.html.vue"]]);export{u as default};
