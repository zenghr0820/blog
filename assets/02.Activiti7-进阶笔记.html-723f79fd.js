import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o,c,d as n,e as s,b as i,w as l,a}from"./app-84ddd078.js";const u={},k=a(`<h1 id="activiti7-è¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#activiti7-è¿›é˜¶" aria-hidden="true">#</a> Activiti7 è¿›é˜¶</h1><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ¶‰åŠ æµç¨‹å®šä¹‰ç›¸å…³ã€æµç¨‹å®ä¾‹ç›¸å…³ã€ä»»åŠ¡åˆ†é…ã€æµç¨‹å˜é‡ã€ä»»åŠ¡å€™é€‰äººã€ç½‘å…³ç­‰æ“ä½œ</p></div><h2 id="æµç¨‹å®šä¹‰ç›¸å…³" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å®šä¹‰ç›¸å…³" aria-hidden="true">#</a> æµç¨‹å®šä¹‰ç›¸å…³</h2><blockquote><p>æ¶‰åŠæµç¨‹å®šä¹‰ä¿¡æ¯æŸ¥è¯¢ã€åˆ é™¤ä»¥åŠå¯¹åº”çš„èµ„æºæŸ¥è¯¢ä¸‹è½½ç­‰æ“ä½œ</p></blockquote><h3 id="æŸ¥è¯¢æµç¨‹å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢æµç¨‹å®šä¹‰" aria-hidden="true">#</a> æŸ¥è¯¢æµç¨‹å®šä¹‰</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–ä»“åº“æœåŠ¡</span>
    <span class="token class-name">RepositoryService</span> repositoryService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRepositoryService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æµç¨‹å®šä¹‰é›†åˆ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProcessDefinition</span><span class="token punctuation">&gt;</span></span> processDefinitionList <span class="token operator">=</span> repositoryService
            <span class="token punctuation">.</span><span class="token function">createProcessDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveProcess&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//éå†é›†åˆ</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProcessDefinition</span> definition<span class="token operator">:</span>processDefinitionList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰ID:&quot;</span><span class="token operator">+</span>definition<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰åç§°:&quot;</span><span class="token operator">+</span>definition<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰key:&quot;</span><span class="token operator">+</span>definition<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰ç‰ˆæœ¬:&quot;</span><span class="token operator">+</span>definition<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹éƒ¨ç½²ID:&quot;</span><span class="token operator">+</span>definition<span class="token punctuation">.</span><span class="token function">getDeploymentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;====================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ é™¤æµç¨‹å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æµç¨‹å®šä¹‰" aria-hidden="true">#</a> åˆ é™¤æµç¨‹å®šä¹‰</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDeleteDeploy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//æµç¨‹éƒ¨ç½²Id</span>
    <span class="token class-name">String</span> deploymentId <span class="token operator">=</span> <span class="token string">&quot;10001&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–ä»“åº“æœåŠ¡</span>
    <span class="token class-name">RepositoryService</span> repositoryService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRepositoryService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ é™¤æµç¨‹å®šä¹‰ï¼Œå¦‚æœè¯¥æµç¨‹å®šä¹‰å·²æœ‰æµç¨‹å®ä¾‹å¯åŠ¨åˆ™åˆ é™¤æ—¶å‡ºé”™</span>
    repositoryService<span class="token punctuation">.</span><span class="token function">deleteDeployment</span><span class="token punctuation">(</span>deploymentId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®true çº§è”åˆ é™¤æµç¨‹å®šä¹‰ï¼Œå³ä½¿è¯¥æµç¨‹æœ‰æµç¨‹å®ä¾‹å¯åŠ¨ä¹Ÿå¯ä»¥åˆ é™¤ï¼Œè®¾ç½®ä¸ºfalseéçº§åˆ«åˆ é™¤æ–¹å¼ï¼Œå¦‚æœæµç¨‹</span>
    <span class="token comment">//repositoryService.deleteDeployment(deploymentId,true);</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´æ˜ï¼š</p><ol><li><p>å¦‚æœè¯¥æµç¨‹å®šä¹‰ä¸‹æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„æµç¨‹ï¼Œåˆ™å¯ä»¥ç”¨æ™®é€šåˆ é™¤</p></li><li><p>å¦‚æœè¯¥æµç¨‹å®šä¹‰ä¸‹å­˜åœ¨å·²ç»è¿è¡Œçš„æµç¨‹ï¼Œä½¿ç”¨æ™®é€šåˆ é™¤æŠ¥é”™ï¼Œå¯ç”¨çº§è”åˆ é™¤æ–¹æ³•å°†æµç¨‹åŠç›¸å…³è®°å½•å…¨éƒ¨åˆ é™¤ã€‚</p></li><li><p>é¡¹ç›®å¼€å‘ä¸­çº§è”åˆ é™¤æ“ä½œä¸€èˆ¬åªå¼€æ”¾ç»™è¶…çº§ç®¡ç†å‘˜ä½¿ç”¨.</p></li></ol><h3 id="æµç¨‹èµ„æºä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#æµç¨‹èµ„æºä¸‹è½½" aria-hidden="true">#</a> æµç¨‹èµ„æºä¸‹è½½</h3><blockquote><p>æˆ‘ä»¬çš„æµç¨‹èµ„æºæ–‡ä»¶å·²ç»ä¸Šä¼ åˆ°æ•°æ®åº“äº†ï¼Œå¦‚æœå…¶ä»–ç”¨æˆ·æƒ³è¦æŸ¥çœ‹è¿™äº›èµ„æºæ–‡ä»¶ï¼Œå¯ä»¥ä»æ•°æ®åº“ä¸­æŠŠèµ„æºæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDownloadResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–ä»“åº“æœåŠ¡</span>
    <span class="token class-name">RepositoryService</span> repositoryService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRepositoryService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æµç¨‹å®šä¹‰é›†åˆ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProcessDefinition</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> repositoryService
            <span class="token punctuation">.</span><span class="token function">createProcessDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveProcess&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">orderByProcessDefinitionVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//æŒ‰ç…§ç‰ˆæœ¬æ’åº</span>
            <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//é™åº</span>
            <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æœ€æ–°é‚£ä¸ª</span>
    <span class="token class-name">ProcessDefinition</span> definition <span class="token operator">=</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–éƒ¨ç½²ID</span>
    <span class="token class-name">String</span> deploymentId <span class="token operator">=</span> definition<span class="token punctuation">.</span><span class="token function">getDeploymentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–bpmnçš„è¾“å…¥æµ</span>
    <span class="token class-name">InputStream</span> bpmnInput <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>
                                        deploymentId<span class="token punctuation">,</span>
                                        definition<span class="token punctuation">.</span><span class="token function">getResourceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–pngçš„è¾“å…¥æµ</span>
    <span class="token class-name">InputStream</span> pngInput <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>
                                        deploymentId<span class="token punctuation">,</span>
                                        definition<span class="token punctuation">.</span><span class="token function">getDiagramResourceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®bpmnè¾“å…¥</span>
    <span class="token class-name">FileOutputStream</span> bpmnOutPut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;D:/leave.bpmn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®pngè¾“å…¥</span>
    <span class="token class-name">FileOutputStream</span> pngOutPut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;D:/leave.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>bpmnInput<span class="token punctuation">,</span>bpmnOutPut<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>pngInput<span class="token punctuation">,</span>pngOutPut<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æµç¨‹å®ä¾‹ç›¸å…³" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å®ä¾‹ç›¸å…³" aria-hidden="true">#</a> æµç¨‹å®ä¾‹ç›¸å…³</h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµç¨‹å‘èµ·ä¹‹åï¼Œç›®å‰è®¾å®šçš„éƒ¨é—¨å®¡æ‰¹äººéƒ½æ˜¯æå››ï¼Œæå››åœ¨å®¡æ‰¹ä¹‹å‰éœ€è¦çœ‹åˆ°ç”³è¯·äººç”³è¯·çš„æ—¶é—´å’Œç”³è¯·çš„ç†ç”±ï¼Œæ‰èƒ½å†³å®šæ˜¯å¦åŒæ„</p><p>é‚£ä¹ˆç”³è¯·äººçš„è¯·å‡ä¿¡æ¯ã€è¯·å‡æ—¶é—´ã€è¯·å‡ç†ç”±ã€‘æ˜¯å¦‚ä½•ç»‘å®šåˆ°æµç¨‹ä¸­çš„å‘¢?</p><p>æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨åˆ°<code>BusinessKey</code></p></div><h3 id="ä¸šåŠ¡æ ‡è¯†-businesskey" tabindex="-1"><a class="header-anchor" href="#ä¸šåŠ¡æ ‡è¯†-businesskey" aria-hidden="true">#</a> ä¸šåŠ¡æ ‡è¯†ï¼ˆBusinessKeyï¼‰</h3><ul><li>å¯åŠ¨æµç¨‹å®ä¾‹æ—¶ï¼ŒæŒ‡å®šçš„ <strong>businessKey</strong> å°±ä¼šåœ¨ <strong>act_run_execution</strong> è¡¨ä¸­å­˜å‚¨ businessKeyã€‚</li><li><strong>BusinessKey</strong>ï¼šä¸šåŠ¡æ ‡è¯†ï¼Œé€šå¸¸ä¸ºä¸šåŠ¡è¡¨çš„ä¸»é”®ï¼Œä¸šåŠ¡æ ‡è¯†å’Œæµç¨‹å®ä¾‹ä¸€ä¸€å¯¹åº”ã€‚ä¸šåŠ¡æ ‡è¯†æ¥æºäºä¸šåŠ¡ç³»ç»Ÿã€‚å­˜å‚¨ä¸šåŠ¡æ ‡è¯†å°±æ˜¯æ ¹æ®ä¸šåŠ¡æ ‡è¯†æ¥å…³è”æŸ¥è¯¢ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ã€‚</li><li>æ¯”å¦‚ï¼šè¯·å‡æµç¨‹å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œå°±å¯ä»¥å°†è¯·å‡å•çš„idä½œä¸ºä¸šåŠ¡æ ‡è¯†å­˜å‚¨åˆ°Activitiä¸­ï¼Œå°†æ¥æŸ¥è¯¢Activitiçš„æµç¨‹å®ä¾‹ä¿¡æ¯å°±å¯ä»¥è·å–è¯·å‡å•çš„idä»è€Œå…³è”æŸ¥è¯¢ä¸šåŠ¡ç³»ç»Ÿæ•°æ®åº“å¾—åˆ°è¯·å‡å•ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºğŸ‘‡</li></ul><img src="https://media.zenghr.cn/blog/img/20210722/hTmP6C.png" alt="hTmP6C"><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStartProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> businessKey <span class="token operator">=</span> <span class="token string">&quot;8001&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–RuntimeServiceå¯¹è±¡</span>
    <span class="token class-name">RuntimeService</span> runtimeService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRuntimeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®å¯¹åº”çš„å‚æ•°</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> variables <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®éƒ¨é—¨å®¡æ ¸äºº</span>
    variables<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;deptLeader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®æµç¨‹å®šä¹‰çš„keyå¯åŠ¨æµç¨‹å®ä¾‹,è¿™ä¸ªkeyæ˜¯åœ¨å®šä¹‰bpmnçš„æ—¶å€™è®¾ç½®çš„</span>
    <span class="token comment">//åœ¨å¯åŠ¨æµç¨‹çš„æ—¶å€™å°†ä¸šåŠ¡keyåŠ å…¥è¿›å»</span>
    <span class="token class-name">ProcessInstance</span> instance <span class="token operator">=</span> runtimeService
            <span class="token punctuation">.</span><span class="token function">startProcessInstanceByKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveProcess&quot;</span><span class="token punctuation">,</span> businessKey<span class="token punctuation">,</span> variables<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æµç¨‹å®ä¾‹çš„ç›¸å…³ä¿¡æ¯</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰çš„id = &quot;</span> <span class="token operator">+</span> instance<span class="token punctuation">.</span><span class="token function">getProcessDefinitionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹çš„id = &quot;</span> <span class="token operator">+</span> instance<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>è·å–<code>BusinessKey</code>å¹¶å…³è”å¯¹åº”çš„ä¸šåŠ¡ä¿¡æ¯</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//è·å–ä»»åŠ¡é›†åˆ</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveProcess&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>assignee<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//éå†ä»»åŠ¡åˆ—è¡¨</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token operator">:</span>taskList<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getProcessDefinitionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä»»åŠ¡id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä»»åŠ¡åç§° = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æ ¹æ®ä»»åŠ¡ä¸Šçš„æµç¨‹å®ä¾‹IdæŸ¥è¯¢å‡ºå¯¹åº”çš„æµç¨‹å®ä¾‹å¯¹è±¡ï¼Œä»æµç¨‹å®ä¾‹å¯¹è±¡ä¸­è·å–BusinessKey</span>
  <span class="token class-name">ProcessInstance</span> instance <span class="token operator">=</span> runtimeService
    <span class="token punctuation">.</span><span class="token function">createProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸šåŠ¡key:&quot;</span><span class="token operator">+</span>instance<span class="token punctuation">.</span><span class="token function">getBusinessKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æµç¨‹æŒ‚èµ·ã€æ¿€æ´»" tabindex="-1"><a class="header-anchor" href="#æµç¨‹æŒ‚èµ·ã€æ¿€æ´»" aria-hidden="true">#</a> æµç¨‹æŒ‚èµ·ã€æ¿€æ´»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSuspendAllProcessInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–RepositoryService</span>
    <span class="token class-name">RepositoryService</span> repositoryService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRepositoryService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æµç¨‹å®šä¹‰å¯¹è±¡</span>
    <span class="token class-name">ProcessDefinition</span> processDefinition <span class="token operator">=</span> repositoryService
            <span class="token punctuation">.</span><span class="token function">createProcessDefinitionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveProcess&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> suspended <span class="token operator">=</span> processDefinition<span class="token punctuation">.</span><span class="token function">isSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è¾“å‡ºæµç¨‹å®šä¹‰çŠ¶æ€</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰çŠ¶æ€:&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>suspended <span class="token operator">?</span><span class="token string">&quot;å·²æŒ‚èµ·&quot;</span><span class="token operator">:</span><span class="token string">&quot;å·²æ¿€æ´»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> processDefinitionId <span class="token operator">=</span> processDefinition<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>suspended<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//å¦‚æœæ˜¯æŒ‚èµ·ï¼Œå¯ä»¥æ‰§è¡Œæ¿€æ´»æ“ä½œ ,å‚æ•°1 ï¼šæµç¨‹å®šä¹‰id ï¼Œå‚æ•°2ï¼šæ˜¯å¦æ¿€æ´»æµç¨‹å®ä¾‹ï¼Œå‚æ•°3ï¼šæ¿€æ´»æ—¶é—´</span>
        repositoryService<span class="token punctuation">.</span><span class="token function">activateProcessDefinitionById</span><span class="token punctuation">(</span>processDefinitionId<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹ID:&quot;</span><span class="token operator">+</span>processDefinitionId<span class="token operator">+</span><span class="token string">&quot;,å·²æ¿€æ´»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">//å¦‚æœæ˜¯æ¿€æ´»ï¼Œå¯ä»¥æ‰§è¡ŒæŒ‚èµ·æ“ä½œ ,å‚æ•°1 ï¼šæµç¨‹å®šä¹‰id ï¼Œå‚æ•°2ï¼šæ˜¯å¦æš‚åœæµç¨‹å®ä¾‹ï¼Œå‚æ•°3ï¼šæ¿€æ´»æ—¶é—´</span>
        repositoryService<span class="token punctuation">.</span><span class="token function">suspendProcessDefinitionById</span><span class="token punctuation">(</span>processDefinitionId<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹ID:&quot;</span><span class="token operator">+</span>processDefinitionId<span class="token operator">+</span><span class="token string">&quot;,å·²æŒ‚èµ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ“ä½œæµç¨‹å®šä¹‰ä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œè¯¥æ“ä½œå®šä¹‰ä¸‹é¢çš„æ‰€æœ‰çš„æµç¨‹å®ä¾‹å°†å…¨éƒ¨æš‚åœ</li><li>æµç¨‹å®šä¹‰ä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œè¯¥æµç¨‹å®šä¹‰ä¸‹å°†ä¸å…è®¸å¯åŠ¨æ–°çš„æµç¨‹å®ä¾‹ï¼ŒåŒæ—¶è¯¥æµç¨‹å®šä¹‰ä¸‹çš„æ‰€æœ‰æµç¨‹å®ä¾‹å°†å…¨éƒ¨æŒ‚èµ·æš‚åœæ‰§è¡Œ</li></ul><p><strong>æµç¨‹å®ä¾‹æŒ‚èµ·ã€æ¿€æ´»</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSuspendSingleProcessInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//æµç¨‹å®ä¾‹Id</span>
    <span class="token class-name">String</span> processInstanceId <span class="token operator">=</span> <span class="token string">&quot;2501&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–RepositoryService</span>
    <span class="token class-name">RuntimeService</span> runtimeService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRuntimeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®æµç¨‹å®ä¾‹Idè·å–æµç¨‹å®ä¾‹å¯¹è±¡</span>
    <span class="token class-name">ProcessInstance</span> processInstance <span class="token operator">=</span> runtimeService
            <span class="token punctuation">.</span><span class="token function">createProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//çŠ¶æ€</span>
    <span class="token keyword">boolean</span> suspended <span class="token operator">=</span> processInstance<span class="token punctuation">.</span><span class="token function">isSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹ID:&quot;</span><span class="token operator">+</span>processInstanceId<span class="token operator">+</span><span class="token string">&quot;,çŠ¶æ€:&quot;</span><span class="token operator">+</span> <span class="token punctuation">(</span>suspended<span class="token operator">?</span><span class="token string">&quot;å·²æŒ‚èµ·&quot;</span><span class="token operator">:</span><span class="token string">&quot;å·²æ¿€æ´»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>suspended<span class="token punctuation">)</span><span class="token punctuation">{</span>
        runtimeService<span class="token punctuation">.</span><span class="token function">activateProcessInstanceById</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹ID:&quot;</span><span class="token operator">+</span>processInstanceId<span class="token operator">+</span><span class="token string">&quot;,çŠ¶æ€ä¿®æ”¹ä¸ºå·²æ¿€æ´»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        runtimeService<span class="token punctuation">.</span><span class="token function">suspendProcessInstanceById</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹ID:&quot;</span><span class="token operator">+</span>processInstanceId<span class="token operator">+</span><span class="token string">&quot;,çŠ¶æ€ä¿®æ”¹ä¸ºå·²æŒ‚èµ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»»åŠ¡åˆ†é…è´Ÿè´£äºº" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡åˆ†é…è´Ÿè´£äºº" aria-hidden="true">#</a> ä»»åŠ¡åˆ†é…è´Ÿè´£äºº</h2><h3 id="å›ºå®šåˆ†é…" tabindex="-1"><a class="header-anchor" href="#å›ºå®šåˆ†é…" aria-hidden="true">#</a> å›ºå®šåˆ†é…</h3><p>åœ¨è¿›è¡Œä¸šåŠ¡æµç¨‹å»ºæ¨¡çš„æ—¶å€™æŒ‡å®šå›ºå®šçš„ä»»åŠ¡è´Ÿè´£äºº</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/ASn38W.png" alt="ASn38W" tabindex="0" loading="lazy"><figcaption>ASn38W</figcaption></figure><h3 id="uel-è¡¨è¾¾å¼åˆ†é…" tabindex="-1"><a class="header-anchor" href="#uel-è¡¨è¾¾å¼åˆ†é…" aria-hidden="true">#</a> UEL è¡¨è¾¾å¼åˆ†é…</h3><p>Activiti ä½¿ç”¨ UEL è¡¨è¾¾å¼ï¼Œ UEL æ˜¯ java EE6 è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œ UELï¼ˆUnified Expression Languageï¼‰å³ ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/posPxS.png" alt="posPxS" tabindex="0" loading="lazy"><figcaption>posPxS</figcaption></figure><h3 id="ç›‘å¬å™¨åˆ†é…-ä½¿ç”¨éº»çƒ¦-æå°‘ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬å™¨åˆ†é…-ä½¿ç”¨éº»çƒ¦-æå°‘ä½¿ç”¨" aria-hidden="true">#</a> ç›‘å¬å™¨åˆ†é…(ä½¿ç”¨éº»çƒ¦,æå°‘ä½¿ç”¨)</h3><ul><li>ä»»åŠ¡ç›‘å¬å™¨æ˜¯å‘ç”Ÿå¯¹åº”çš„ä»»åŠ¡ç›¸å…³äº‹ä»¶æ—¶æ‰§è¡Œè‡ªå®šä¹‰çš„Javaé€»è¾‘æˆ–è¡¨è¾¾å¼</li><li>ä»»åŠ¡ç›¸å…³äº‹ä»¶åŒ…æ‹¬ï¼š <ul><li><strong>Eventï¼š</strong><ul><li>Createï¼šä»»åŠ¡åˆ›å»ºåè§¦å‘ã€‚</li><li>Assignmentï¼šä»»åŠ¡åˆ†é…åè§¦å‘ã€‚</li><li>Deleteï¼šä»»åŠ¡å®Œæˆåè§¦å‘ã€‚</li><li>Allï¼šæ‰€æœ‰äº‹ä»¶å‘ç”Ÿéƒ½è§¦å‘ã€‚</li></ul></li></ul></li></ul><p><strong>1. è‡ªå®šä¹‰ä¸€ä¸ªä»»åŠ¡ç›‘å¬å™¨ç±»ï¼Œç„¶åæ­¤ç±»å¿…é¡»å®ç°org.activiti.engine.delegate.TaskListeneræ¥å£</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTaskListener</span> <span class="token keyword">implements</span> <span class="token class-name">TaskListener</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token class-name">DelegateTask</span> delegateTask<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//è¿™é‡ŒæŒ‡å®šä»»åŠ¡è´Ÿè´£äºº</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>delegateTask<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;éƒ¨é—¨ç»ç†å®¡æ‰¹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      delegateTask<span class="token punctuation">.</span><span class="token function">setAssignee</span><span class="token punctuation">(</span><span class="token string">&quot;èµµå…­&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>delegateTask<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;éƒ¨é—¨ç»ç†å®¡æ‰¹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      delegateTask<span class="token punctuation">.</span><span class="token function">setAssignee</span><span class="token punctuation">(</span><span class="token string">&quot;å­™ä¸ƒ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2. åœ¨bpmnæ–‡ä»¶ä¸­é…ç½®ç›‘å¬å™¨</strong></p><figure><img src="https://media.zenghr.cn/blog/img/20210722/upZLYx.png" alt="upZLYx" tabindex="0" loading="lazy"><figcaption>upZLYx</figcaption></figure><h2 id="æµç¨‹å˜é‡" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å˜é‡" aria-hidden="true">#</a> æµç¨‹å˜é‡</h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµç¨‹å˜é‡åœ¨Activitiä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è§’è‰²ï¼Œæµç¨‹è¿è½¬æœ‰æ—¶éœ€è¦é æµç¨‹å˜é‡ï¼Œä¸šåŠ¡ç³»ç»Ÿå’ŒActivitiç»“åˆæ—¶å°‘ä¸äº†æµç¨‹å˜é‡ï¼Œæµç¨‹å˜é‡å°±æ˜¯Activitiåœ¨ç®¡ç†å·¥ä½œæµæ—¶æ ¹æ®ç®¡ç†éœ€è¦è€Œè®¾ç½®çš„å˜é‡</p><p>æ¯”å¦‚åœ¨è¯·å‡æµç¨‹æµè½¬æ—¶å¦‚æœ <strong>è¯·å‡å¤©æ•°&gt;3</strong> å¤©åˆ™æœ‰æ€»ç»ç†å®¡æ‰¹ï¼Œå¦åˆ™ç”±äººäº‹ç›´æ¥å®¡æ‰¹ï¼Œè¯·å‡å¤©æ•°å°±å¯ä»¥è®¾ç½®æµç¨‹å˜é‡ï¼Œåœ¨æµç¨‹æµè½¬æ—¶ä½¿ç”¨</p></div><h3 id="æµç¨‹å˜é‡ç±»å‹" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å˜é‡ç±»å‹" aria-hidden="true">#</a> æµç¨‹å˜é‡ç±»å‹</h3><figure><img src="https://media.zenghr.cn/blog/img/20210722/JdYxvc.png" alt="JdYxvc" tabindex="0" loading="lazy"><figcaption>JdYxvc</figcaption></figure><blockquote><p>æ³¨æ„ï¼šå¦‚æœå°†POJOå­˜å‚¨åˆ°æµç¨‹å˜é‡ä¸­ï¼Œå¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£Serializableï¼Œä¸ºäº†é˜²æ­¢ç”±äºæ–°å¢å­—æ®µæ— æ³•ååºåˆ—åŒ–</p></blockquote><h3 id="æµç¨‹å˜é‡çš„ä½œç”¨åŸŸ" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å˜é‡çš„ä½œç”¨åŸŸ" aria-hidden="true">#</a> æµç¨‹å˜é‡çš„ä½œç”¨åŸŸ</h3><p>æµç¨‹å˜é‡çš„ä½œç”¨åŸŸèŒƒå›´å¯ä»¥æ˜¯ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼ˆProcessInstanceï¼‰ã€ä¸€ä¸ªä»»åŠ¡ï¼ˆTaskï¼‰æˆ–ä¸€ä¸ªæ‰§è¡Œå®ä¾‹ï¼ˆExecutionï¼‰</p><ul><li><strong>globalå˜é‡</strong> : æµç¨‹å˜é‡çš„ä½œç”¨åŸŸèŒƒå›´çš„é»˜è®¤å€¼æ˜¯æµç¨‹å®ä¾‹ï¼Œä½œç”¨åŸŸèŒƒå›´æœ€å¤§ã€‚</li><li><strong>localå˜é‡</strong> : æµç¨‹å˜é‡çš„ä½œç”¨åŸŸèŒƒå›´å¦‚æœä»…ä»…é’ˆå¯¹ä¸€ä¸ªä»»åŠ¡æˆ–ä¸€ä¸ªæ‰§è¡Œå®ä¾‹ï¼Œé‚£ä¹ˆä½œç”¨åŸŸèŒƒå›´æ²¡æœ‰æµç¨‹å®ä¾‹å¤§</li></ul><blockquote><p>å®é™…å¼€å‘ä¸­ä¸€èˆ¬ä¸ç”¨localå˜é‡ï¼Œäº†è§£å³å¯</p></blockquote><h3 id="æµç¨‹å˜é‡çš„ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æµç¨‹å˜é‡çš„ä½¿ç”¨æ–¹æ³•" aria-hidden="true">#</a> æµç¨‹å˜é‡çš„ä½¿ç”¨æ–¹æ³•</h3><ul><li><p><strong>åœ¨å±æ€§ä¸Šä½¿ç”¨UELè¡¨è¾¾å¼</strong></p><p>å¯ä»¥åœ¨ assignee å¤„è®¾ç½® UEL è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼çš„å€¼ä¸ºä»»åŠ¡çš„è´Ÿè´£äººï¼Œæ¯”å¦‚ï¼š <code>\${assignee}ï¼Œ assignee</code> å°±æ˜¯ä¸€ä¸ªæµç¨‹å˜é‡åç§°ã€‚</p><p>Activitiè·å– UELè¡¨è¾¾å¼ çš„å€¼ï¼Œå³æµç¨‹å˜é‡ assignee çš„å€¼ ï¼Œå°† assignee çš„å€¼ä½œä¸ºä»»åŠ¡çš„è´Ÿè´£äººè¿›è¡Œä»»åŠ¡åˆ†é…</p></li><li><p><strong>åœ¨è¿çº¿ä¸Šä½¿ç”¨UELè¡¨è¾¾å¼</strong></p><p>å¯ä»¥åœ¨è¿çº¿ä¸Šè®¾ç½®UELè¡¨è¾¾å¼ï¼Œå†³å®šæµç¨‹èµ°å‘ã€‚</p><p>æ¯”å¦‚ï¼š<code>\${price&lt;10000}</code> priceå°±æ˜¯ä¸€ä¸ªæµç¨‹å˜é‡åç§°ï¼Œuelè¡¨è¾¾å¼ç»“æœç±»å‹ä¸ºå¸ƒå°”ç±»å‹ã€‚</p><p>å¦‚æœUELè¡¨è¾¾å¼æ˜¯trueï¼Œè¦å†³å®š æµç¨‹æ‰§è¡Œèµ°å‘</p></li></ul><h3 id="ä½¿ç”¨globalå˜é‡æ§åˆ¶æµç¨‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨globalå˜é‡æ§åˆ¶æµç¨‹" aria-hidden="true">#</a> ä½¿ç”¨globalå˜é‡æ§åˆ¶æµç¨‹</h3><p>åœ¨è¿çº¿å¤„æ·»åŠ åˆ¤æ–­æ¡ä»¶</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/eI0vjg.png" alt="eI0vjg" tabindex="0" loading="lazy"><figcaption>eI0vjg</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStartProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–RuntimeServiceå¯¹è±¡</span>
    <span class="token class-name">RuntimeService</span> runtimeService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRuntimeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> variables <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    variables<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;day&quot;</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®æµç¨‹å®šä¹‰çš„keyå¯åŠ¨æµç¨‹å®ä¾‹,è¿™ä¸ªkeyæ˜¯åœ¨å®šä¹‰bpmnçš„æ—¶å€™è®¾ç½®çš„</span>
    <span class="token class-name">ProcessInstance</span> instance <span class="token operator">=</span> runtimeService<span class="token punctuation">.</span><span class="token function">startProcessInstanceByKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveVariablesProcess&quot;</span><span class="token punctuation">,</span>variables<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–æµç¨‹å®ä¾‹çš„ç›¸å…³ä¿¡æ¯</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰çš„id = &quot;</span> <span class="token operator">+</span> instance<span class="token punctuation">.</span><span class="token function">getProcessDefinitionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹çš„id = &quot;</span> <span class="token operator">+</span> instance<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‰§è¡Œtask-è®¾ç½®æµç¨‹å˜é‡" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œtask-è®¾ç½®æµç¨‹å˜é‡" aria-hidden="true">#</a> æ‰§è¡Œtask è®¾ç½®æµç¨‹å˜é‡</h3><p><strong><code>taskService.setVariable(taskId,variableName,variableValue)</code></strong></p><ul><li><strong>taskId</strong> - ä»»åŠ¡ ID</li><li><strong>variableName</strong> - å˜é‡åç§°</li><li><strong>variableValue</strong> - å˜é‡å®é™…çš„å€¼</li></ul><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p>1.å¦‚æœUELè¡¨è¾¾å¼ä¸­æµç¨‹å˜é‡åä¸å­˜åœ¨åˆ™æŠ¥é”™ã€‚<br> 2.å¦‚æœå¦‚æœUELè¡¨è¾¾å¼éƒ½ä¸ç¬¦åˆæ¡ä»¶,æµç¨‹æŠ¥é”™ã€‚<br> 3.å¦‚æœè¿æ¥ä¸è®¾ç½®æ¡ä»¶/æ¡ä»¶éƒ½æ»¡è¶³,æ¯ä¸ªè¿çº¿éƒ½ä¼šèµ°</p></div><h2 id="ä»»åŠ¡å€™é€‰äºº" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡å€™é€‰äºº" aria-hidden="true">#</a> ä»»åŠ¡å€™é€‰äºº</h2><p>åœ¨æµç¨‹å®šä¹‰ä¸­åœ¨ä»»åŠ¡ç»“ç‚¹çš„ assignee å›ºå®šè®¾ç½®ä»»åŠ¡è´Ÿè´£äººï¼Œåœ¨æµç¨‹å®šä¹‰æ—¶å°†å‚ä¸è€…å›ºå®šè®¾ç½®åœ¨.bpmn æ–‡ä»¶ä¸­ï¼Œå¦‚æœä¸´æ—¶ä»»åŠ¡è´Ÿè´£äººå˜æ›´åˆ™éœ€è¦ä¿®æ”¹æµç¨‹å®šä¹‰ï¼Œç³»ç»Ÿå¯æ‰©å±•æ€§å·®ã€‚</p><p>é’ˆå¯¹è¿™ç§æƒ…å†µå¯ä»¥ç»™ä»»åŠ¡è®¾ç½®å¤šä¸ªå€™é€‰äººï¼Œå¯ä»¥ä»å€™é€‰äººä¸­é€‰æ‹©å‚ä¸è€…æ¥å®Œæˆä»»åŠ¡</p><h3 id="è®¾ç½®ä»»åŠ¡å€™é€‰äºº" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®ä»»åŠ¡å€™é€‰äºº" aria-hidden="true">#</a> è®¾ç½®ä»»åŠ¡å€™é€‰äºº</h3><p>åœ¨æµç¨‹å›¾ä¸­ä»»åŠ¡èŠ‚ç‚¹çš„é…ç½®ä¸­è®¾ç½® candidate-users(å€™é€‰äºº)ï¼Œå¤šä¸ªå€™é€‰äººä¹‹é—´ç”¨é€—å·åˆ†å¼€</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/YywESD.png" alt="YywESD" tabindex="0" loading="lazy"><figcaption>YywESD</figcaption></figure><p><strong>ä½¿ç”¨ Api è®¾ç½®å€™é€‰äºº</strong></p><p><strong><code>taskService.addCandidateUser(taskId,candidateUser)</code></strong></p><ul><li><strong>taskIdï¼š</strong> ä»»åŠ¡ Id</li><li><strong>candidateUser:</strong> å€™é€‰äºº</li></ul><h3 id="æŸ¥è¯¢å€™é€‰äººä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢å€™é€‰äººä»»åŠ¡" aria-hidden="true">#</a> æŸ¥è¯¢å€™é€‰äººä»»åŠ¡</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//æŸ¥è¯¢å€™é€‰ä»»åŠ¡</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSelectCandidateTaskList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//ä»»åŠ¡è´Ÿè´£äºº</span>
    <span class="token class-name">String</span> candidateUser <span class="token operator">=</span> <span class="token string">&quot;æå››&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–TaskService</span>
    <span class="token class-name">TaskService</span> taskService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getTaskService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–ä»»åŠ¡é›†åˆ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;leaveCandidateProcess&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">taskCandidateUser</span><span class="token punctuation">(</span>candidateUser<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//éå†ä»»åŠ¡åˆ—è¡¨</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Task</span> task<span class="token operator">:</span>taskList<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®šä¹‰id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getProcessDefinitionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµç¨‹å®ä¾‹id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä»»åŠ¡id = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä»»åŠ¡åç§° = &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,69),r={class:"hint-container warning"},d=n("p",{class:"hint-container-title"},"æ³¨æ„",-1),v=a(`<h3 id="é¢†å–ã€å®Œæˆå€™é€‰äººä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#é¢†å–ã€å®Œæˆå€™é€‰äººä»»åŠ¡" aria-hidden="true">#</a> é¢†å–ã€å®Œæˆå€™é€‰äººä»»åŠ¡</h3><blockquote><p>å¦‚æœå€™é€‰ä»»åŠ¡æ²¡æœ‰è¿›è¡Œé¢†å–å°±ç›´æ¥å®Œæˆçš„è¯ï¼Œé‚£ä¹ˆåœ¨å†å²è®°å½•ä¸­å°±ä¸ä¼šè®°å½•æ˜¯å“ªä¸ªç”¨æˆ·æ‰§è¡Œäº†è¿™ä¸ªä»»åŠ¡</p><p>æ‰€ä»¥å¯¹äºè¿™ç§å€™é€‰äººçš„ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé¢†å–å†å®Œæˆ</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testClaimTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//ä»»åŠ¡ID</span>
    <span class="token class-name">String</span> taskId <span class="token operator">=</span> <span class="token string">&quot;2505&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> assignee <span class="token operator">=</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ›å»ºProcessEngineå¯¹è±¡</span>
    <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–TaskService</span>
    <span class="token class-name">TaskService</span> taskService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getTaskService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é¢†å–ä»»åŠ¡</span>
    taskService<span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span>taskId<span class="token punctuation">,</span>assignee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å®Œæˆä»»åŠ¡</span>
  	taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç½‘å…³ç›¸å…³" tabindex="-1"><a class="header-anchor" href="#ç½‘å…³ç›¸å…³" aria-hidden="true">#</a> ç½‘å…³ç›¸å…³</h2><h3 id="æ’ä»–ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#æ’ä»–ç½‘å…³" aria-hidden="true">#</a> æ’ä»–ç½‘å…³</h3><p>æ’ä»–ç½‘å…³(ExclusiveGateway)ï¼ˆå¼‚æˆ–ç½‘å…³æˆ–åŸºäºæ•°æ®çš„æ’ä»–ç½‘å…³ï¼‰ï¼Œç”¨æ¥åœ¨æµç¨‹ä¸­å®ç°å†³ç­–ã€‚å½“æµç¨‹æ‰§è¡Œåˆ°è¿™ä¸ªç½‘å…³çš„æ—¶å€™ï¼Œæ‰€æœ‰åˆ†æ”¯éƒ½ä¼šåˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºtrueï¼Œå¦‚æœä¸ºtrueåˆ™æ‰§è¡Œè¯¥åˆ†æ”¯</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/fdgdQz.png" alt="fdgdQz" tabindex="0" loading="lazy"><figcaption>fdgdQz</figcaption></figure><h3 id="å¹¶è¡Œç½‘å…³" tabindex="-1"><a class="header-anchor" href="#å¹¶è¡Œç½‘å…³" aria-hidden="true">#</a> å¹¶è¡Œç½‘å…³</h3><p>å¹¶è¡Œç½‘å…³(InclusiveGateway)å…è®¸å°†æµç¨‹åˆ†æˆå¤šæ¡åˆ†æ”¯ï¼Œä¹Ÿå¯ä»¥æŠŠå¤šæ¡åˆ†æ”¯æ±‡èšåˆ°ä¸€èµ·ï¼Œå¹¶è¡Œç½‘å…³çš„åŠŸèƒ½æ˜¯åŸºäºè¿›å…¥å’Œå¤–å‡ºçš„é¡ºåºæµçš„</p><blockquote><p>å¹¶è¡Œç½‘å…³ä¸ä¼šè§£ææ¡ä»¶ã€‚å³ä½¿é¡ºåºæµä¸­å®šä¹‰äº†æ¡ä»¶ï¼Œä¹Ÿä¼šè¢«å¿½ç•¥</p></blockquote><figure><img src="https://media.zenghr.cn/blog/img/20210722/J4KD0z.png" alt="J4KD0z" tabindex="0" loading="lazy"><figcaption>J4KD0z</figcaption></figure><h3 id="åŒ…å«ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#åŒ…å«ç½‘å…³" aria-hidden="true">#</a> åŒ…å«ç½‘å…³</h3><p>åŒ…å«ç½‘å…³å¯ä»¥çœ‹åšæ˜¯æ’ä»–ç½‘å…³å’Œå¹¶è¡Œç½‘å…³çš„ç»“åˆä½“</p><figure><img src="https://media.zenghr.cn/blog/img/20210722/bVI3wP.png" alt="bVI3wP" tabindex="0" loading="lazy"><figcaption>bVI3wP</figcaption></figure>`,14);function m(g,b){const t=e("RouterLink");return o(),c("div",null,[k,n("div",r,[d,n("p",null,[s("æ³¨æ„ï¼šåœ¨ SpringBoot é›†æˆ Activiti7 ä¸­ï¼Œä½¿ç”¨è¯¥ Api æŸ¥è¯¢å€™é€‰äººæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¼‚å¸¸è¯¦ç»†ä»¥åŠè§£å†³æ–¹æ¡ˆè¯·çœ‹ "),i(t,{to:"/passages/2021-07-22-activiti7-error-note.html"},{default:l(()=>[s("Activiti7 å¡«å‘ç¬”è®°")]),_:1})])]),v])}const y=p(u,[["render",m],["__file","02.Activiti7-è¿›é˜¶ç¬”è®°.html.vue"]]);export{y as default};
